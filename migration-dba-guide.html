<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migration UTL_FILE - Guide DBA</title>
    <style>
        :root {
            --primary: #0f9d58;
            --primary-dark: #0b7a45;
            --secondary: #1a73e8;
            --warning: #f9ab00;
            --danger: #ea4335;
            --dark: #202124;
            --gray: #5f6368;
            --light-gray: #f1f3f4;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: var(--light-gray);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 40px 20px;
            text-align: center;
        }

        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .badge {
            display: inline-block;
            padding: 5px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        section {
            background: var(--white);
            margin: 20px 0;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--primary);
        }

        section h3 {
            color: var(--dark);
            margin: 20px 0 15px 0;
            font-size: 1.2rem;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin: 15px 0;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .alert-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .alert-success {
            background: #e6f4ea;
            border-left: 4px solid var(--primary);
        }

        .alert-info {
            background: #e8f0fe;
            border-left: 4px solid var(--secondary);
        }

        .alert-warning {
            background: #fef7e0;
            border-left: 4px solid var(--warning);
        }

        .alert-danger {
            background: #fce8e6;
            border-left: 4px solid var(--danger);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.95rem;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid #e0e0e0;
        }

        th {
            background: var(--primary);
            color: var(--white);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: var(--light-gray);
        }

        tr:hover {
            background: #e8f0fe;
        }

        .code-container {
            position: relative;
            margin: 15px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .code-header {
            background: var(--dark);
            color: var(--white);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .copy-btn {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 6px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
        }

        .copy-btn.copied {
            background: var(--secondary);
        }

        pre {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            max-height: 400px;
        }

        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist li {
            padding: 15px;
            margin: 10px 0;
            background: var(--light-gray);
            border-radius: 8px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .checklist li.done {
            background: #e6f4ea;
            border-left: 4px solid var(--primary);
        }

        .checklist li.pending {
            background: #fef7e0;
            border-left: 4px solid var(--warning);
        }

        .checklist li.blocked {
            background: #fce8e6;
            border-left: 4px solid var(--danger);
        }

        .check-box {
            width: 24px;
            height: 24px;
            border: 2px solid var(--gray);
            border-radius: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .check-box.checked {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .step-number {
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .email-template {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: var(--white);
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
        }

        .card h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .tag-toi {
            background: #e6f4ea;
            color: var(--primary);
        }

        .tag-admin {
            background: #e8f0fe;
            color: var(--secondary);
        }

        .tag-attente {
            background: #fef7e0;
            color: #b45309;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        footer {
            background: var(--dark);
            color: var(--white);
            padding: 20px;
            text-align: center;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.6rem;
            }
            section {
                padding: 15px;
            }
        }

        @media print {
            .copy-btn, .check-box {
                display: none;
            }
        }

        /* Navigation par onglets */
        .tabs-nav {
            display: flex;
            background: var(--dark);
            padding: 0;
            margin: 0;
            list-style: none;
            overflow-x: auto;
        }

        .tabs-nav li {
            flex: 0 0 auto;
        }

        .tabs-nav a {
            display: block;
            padding: 15px 25px;
            color: #ccc;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tabs-nav a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .tabs-nav a.active {
            color: white;
            border-bottom-color: var(--primary);
            background: rgba(255,255,255,0.05);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>

<header>
    <h1>üõ†Ô∏è Migration UTL_FILE vers ExaCC</h1>
    <p class="subtitle">Guide DBA - Focus sur ton p√©rim√®tre uniquement</p>
    <span class="badge">Tu g√®res la base ‚Ä¢ Les admins OCI g√®rent le cloud</span>
</header>

<!-- Navigation par onglets -->
<nav>
    <ul class="tabs-nav">
        <li><a href="#guide" class="active" onclick="showTab('guide', this)">üìã Guide Migration</a></li>
        <li><a href="#jira" onclick="showTab('jira', this)">üé´ Tickets JIRA</a></li>
    </ul>
</nav>

<div class="container">

<!-- ==================== ONGLET JIRA ==================== -->
<div id="jira" class="tab-content">

    <section style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: 2px solid #2196f3; margin-top: 20px;">
        <h2>üé´ Tickets JIRA - Migration UTL_FILE vers ExaCC</h2>
        <p style="margin: 15px 0;">3 tickets pour structurer ton projet de migration : Audit ‚Üí Impl√©mentation ‚Üí Tests</p>
    </section>

    <!-- TICKET 1 : AUDIT -->
    <section>
        <h2>üìù Ticket 1 : Audit UTL_FILE</h2>

        <div class="alert alert-info">
            <span class="alert-icon">üîç</span>
            <div>
                <strong>Type :</strong> Story<br>
                <strong>Epic :</strong> Migration ExaCC - Adaptation code PL/SQL<br>
                <strong>Assign√© √† :</strong> DBA
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Titre du ticket</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>[EXACC] Audit des utilisations UTL_FILE</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Description</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Contexte
Dans le cadre de la migration vers ExaCC (Exadata Cloud@Customer), le package UTL_FILE n'est plus disponible car l'acc√®s au filesystem du serveur est supprim√©.

Nous devons identifier toutes les utilisations de UTL_FILE pour planifier la migration vers DBMS_CLOUD + Object Storage.

## Objectif
R√©aliser un audit complet pour identifier et documenter tous les impacts avant migration.

## P√©rim√®tre
- Base de donn√©es : [NOM_BASE]
- Environnement : [PROD/PREPROD/DEV]

## T√¢ches
- [ ] Lister les sch√©mas utilisant UTL_FILE
- [ ] Compter les r√©f√©rences par sch√©ma
- [ ] Lister les objets impact√©s (packages, proc√©dures, fonctions)
- [ ] Identifier les fonctions UTL_FILE utilis√©es (FOPEN, PUT_LINE, GET_LINE, etc.)
- [ ] V√©rifier compatibilit√© avec le wrapper UTL_FILE_WRAPPER
- [ ] Lister les directories Oracle
- [ ] Contacter l'√©diteur si application tierce concern√©e
- [ ] Identifier les jobs Control-M concern√©s
- [ ] Identifier les fichiers volumineux (> 100 Mo)

## Livrables
- Rapport d'audit Excel/CSV avec :
  - Liste des sch√©mas impact√©s
  - Liste des objets par sch√©ma
  - Nombre de r√©f√©rences par objet
  - Liste des directories √† migrer
  - Liste des fonctions UTL_FILE utilis√©es
  - Liste des jobs Control-M impact√©s</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Crit√®res d'acceptation</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Crit√®res d'acceptation

### ‚úÖ DONE quand :

1. **Inventaire sch√©mas**
   - [ ] Tous les sch√©mas applicatifs ont √©t√© analys√©s
   - [ ] La liste des sch√©mas utilisant UTL_FILE est document√©e
   - [ ] Le nombre total de r√©f√©rences UTL_FILE est connu

2. **Inventaire objets**
   - [ ] Pour chaque sch√©ma, la liste des objets impact√©s est fournie
   - [ ] Le nombre de r√©f√©rences par objet est document√©

3. **Fonctions UTL_FILE**
   - [ ] La liste des fonctions UTL_FILE utilis√©es est fournie
   - [ ] La compatibilit√© avec le wrapper est v√©rifi√©e (toutes ‚úÖ OUI)

4. **Directories Oracle**
   - [ ] La liste des directories Oracle est fournie
   - [ ] La correspondance directory ‚Üí chemin physique est document√©e

5. **√âditeur (si applicable)**
   - [ ] L'√©diteur a √©t√© contact√©
   - [ ] La r√©ponse de l'√©diteur est document√©e

6. **Jobs Control-M**
   - [ ] Les jobs utilisant UTL_FILE sont identifi√©s
   - [ ] La liste est transmise √† l'√©quipe ordonnancement

7. **Fichiers volumineux**
   - [ ] Les fichiers > 100 Mo sont identifi√©s
   - [ ] Une strat√©gie est d√©finie pour ces fichiers

8. **Rapport d'audit**
   - [ ] Un fichier Excel/CSV r√©capitulatif est produit
   - [ ] Le rapport est stock√© dans [EMPLACEMENT]

### ‚ùå NOT DONE si :
- Des sch√©mas applicatifs n'ont pas √©t√© analys√©s
- Le rapport d'audit n'est pas produit
- La compatibilit√© des fonctions n'est pas v√©rifi√©e</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Labels sugg√©r√©s</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>migration, exacc, utl_file, audit, dba</code></pre>
        </div>
    </section>

    <!-- TICKET 2 : IMPLEMENTATION -->
    <section>
        <h2>üìù Ticket 2 : Impl√©mentation Migration UTL_FILE</h2>

        <div class="alert alert-success">
            <span class="alert-icon">üîß</span>
            <div>
                <strong>Type :</strong> Story<br>
                <strong>Assign√© √† :</strong> DBA<br>
                <strong>Pr√©requis :</strong> Ticket 1 (Audit) termin√© + Config OCI re√ßue des admins
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Titre du ticket</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>[EXACC] Impl√©mentation wrapper UTL_FILE et synonyme PUBLIC</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Description</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Contexte
Suite √† l'audit (ticket [LIEN_TICKET_1]), nous pouvons d√©ployer la solution de migration.

## Pr√©requis
- [ ] Ticket Audit termin√©
- [ ] Configuration OCI re√ßue des admins :
  - URI du bucket Object Storage
  - Nom du credential DBMS_CLOUD
  - ACL r√©seau confirm√©e
  - Dossiers cr√©√©s dans le bucket

## Solution technique
D√©ployer un package wrapper UTL_FILE_WRAPPER qui :
- Expose les m√™mes signatures que UTL_FILE
- Utilise DBMS_CLOUD en interne pour acc√©der √† Object Storage
- Utilise une table de mapping directory ‚Üí URI Object Storage

Cr√©er un synonyme PUBLIC UTL_FILE ‚Üí UTL_FILE_WRAPPER pour que le code existant fonctionne sans modification.

## T√¢ches
- [ ] Cr√©er la table de mapping UTL_FILE_DIRECTORY_MAPPING
- [ ] Ins√©rer les mappings (directory ‚Üí Object Storage)
- [ ] D√©ployer le package UTL_FILE_WRAPPER (spec + body)
- [ ] Cr√©er le synonyme PUBLIC UTL_FILE
- [ ] Recompiler les sch√©mas impact√©s
- [ ] V√©rifier aucun objet invalide
- [ ] Documenter la proc√©dure de rollback

## Environnement cible
- Base : [NOM_BASE]
- Sch√©mas impact√©s : [LISTE]

## Livrables
- Package UTL_FILE_WRAPPER d√©ploy√©
- Synonyme PUBLIC cr√©√©
- Documentation de rollback</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Crit√®res d'acceptation</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Crit√®res d'acceptation

### ‚úÖ DONE quand :

1. **Table de mapping**
   - [ ] La table UTL_FILE_DIRECTORY_MAPPING est cr√©√©e
   - [ ] Tous les directories identifi√©s dans l'audit sont mapp√©s
   - [ ] Les URI Object Storage sont correctes

2. **Package wrapper**
   - [ ] Le package UTL_FILE_WRAPPER est d√©ploy√©
   - [ ] Le statut est VALID
   - [ ] Le package utilise DBMS_CLOUD en interne

3. **Synonyme PUBLIC**
   - [ ] Le synonyme PUBLIC UTL_FILE pointe vers UTL_FILE_WRAPPER
   - [ ] Le synonyme est visible depuis tous les sch√©mas applicatifs

4. **Recompilation**
   - [ ] Tous les sch√©mas impact√©s sont recompil√©s
   - [ ] Aucun objet n'est en statut INVALID

5. **Rollback**
   - [ ] La proc√©dure de rollback est document√©e
   - [ ] Le script de rollback est test√© sur environnement de test

### ‚ùå NOT DONE si :
- Des objets sont en statut INVALID
- Le rollback n'est pas document√©</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Labels sugg√©r√©s</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>migration, exacc, utl_file, implementation, dba</code></pre>
        </div>
    </section>

    <!-- TICKET 3 : TESTS -->
    <section>
        <h2>üìù Ticket 3 : Tests et Validation</h2>

        <div class="alert alert-warning">
            <span class="alert-icon">‚úÖ</span>
            <div>
                <strong>Type :</strong> Story<br>
                <strong>Assign√© √† :</strong> DBA + QA<br>
                <strong>Pr√©requis :</strong> Ticket 2 (Impl√©mentation) termin√©
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Titre du ticket</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>[EXACC] Tests et validation migration UTL_FILE</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Description</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Contexte
Suite au d√©ploiement du wrapper (ticket [LIEN_TICKET_2]), nous devons valider le bon fonctionnement avant mise en production.

## Objectif
Valider que la migration fonctionne correctement et que le rollback est op√©rationnel.

## T√¢ches
- [ ] Test unitaire √©criture fichier
- [ ] Test unitaire lecture fichier
- [ ] Test avec chaque directory mapp√©
- [ ] V√©rifier fichiers dans Object Storage (console OCI)
- [ ] Test job Control-M (environnement de test)
- [ ] Test avec fichier volumineux (si applicable)
- [ ] Test de rollback (sur environnement de test)
- [ ] Validation avec √©quipe applicative
- [ ] Validation avec √©diteur (si applicable)

## Environnement de test
- Base : [NOM_BASE_TEST]
- Jobs Control-M : [LISTE_JOBS_TEST]

## Livrables
- PV de recette sign√©
- Rapport de tests</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Crit√®res d'acceptation</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Crit√®res d'acceptation

### ‚úÖ DONE quand :

1. **Tests unitaires**
   - [ ] Test √©criture fichier OK
   - [ ] Test lecture fichier OK
   - [ ] Fichiers visibles dans Object Storage

2. **Tests directories**
   - [ ] Chaque directory mapp√© a √©t√© test√©
   - [ ] Les fichiers sont cr√©√©s au bon emplacement

3. **Tests Control-M**
   - [ ] Au moins un job Control-M a √©t√© ex√©cut√© en test
   - [ ] Le job s'est termin√© avec succ√®s
   - [ ] Les fichiers g√©n√©r√©s sont corrects

4. **Test fichiers volumineux** (si applicable)
   - [ ] Un fichier > 100 Mo a √©t√© √©crit avec succ√®s
   - [ ] Le temps d'ex√©cution est acceptable

5. **Validation m√©tier**
   - [ ] L'√©quipe applicative a valid√© les tests
   - [ ] L'√©diteur a valid√© (si applicable)

6. **Documentation**
   - [ ] PV de recette sign√©
   - [ ] Rapport de tests produit

### ‚ùå NOT DONE si :
- Un test est en √©chec
- Le PV de recette n'est pas sign√©</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Labels sugg√©r√©s</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>migration, exacc, utl_file, tests, validation, qa</code></pre>
        </div>
    </section>

    <!-- TICKET 4 : ROLLBACK -->
    <section>
        <h2>üìù Ticket 4 : Rollback et Test Rollback</h2>

        <div class="alert alert-danger">
            <span class="alert-icon">üîÑ</span>
            <div>
                <strong>Type :</strong> Story<br>
                <strong>Assign√© √† :</strong> DBA<br>
                <strong>Pr√©requis :</strong> Ticket 2 (Impl√©mentation) termin√©
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Titre du ticket</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>[EXACC] Rollback et Test Rollback migration UTL_FILE</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Description</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Contexte
En cas de probl√®me apr√®s la migration UTL_FILE vers ExaCC, nous devons pouvoir revenir √† l'√©tat initial (UTL_FILE natif Oracle).

Ce ticket couvre la documentation et le test de la proc√©dure de rollback.

## Objectif
- Documenter la proc√©dure de rollback compl√®te
- Tester le rollback sur environnement de test
- Valider le retour √† UTL_FILE natif

## T√¢ches
- [ ] Documenter la proc√©dure de rollback √©tape par √©tape
- [ ] Cr√©er le script de rollback complet
- [ ] Ex√©cuter le rollback sur environnement de test
- [ ] V√©rifier suppression du synonyme PUBLIC UTL_FILE
- [ ] V√©rifier suppression du package UTL_FILE_WRAPPER
- [ ] V√©rifier suppression de la table de mapping
- [ ] Recompiler les sch√©mas impact√©s
- [ ] V√©rifier aucun objet invalide apr√®s rollback
- [ ] Tester UTL_FILE natif apr√®s rollback
- [ ] Documenter les r√©sultats du test

## Script de rollback
Le script doit :
1. Supprimer le synonyme PUBLIC UTL_FILE
2. Supprimer le package UTL_FILE_WRAPPER
3. Supprimer la table UTL_FILE_DIRECTORY_MAPPING
4. Recompiler tous les sch√©mas impact√©s
5. V√©rifier qu'il n'y a pas d'objets invalides

## Environnement de test
- Base : [NOM_BASE_TEST]

## Livrables
- Documentation proc√©dure de rollback
- Script de rollback test√© et valid√©
- Rapport de test rollback</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Crit√®res d'acceptation</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>## Crit√®res d'acceptation

### ‚úÖ DONE quand :

1. **Documentation**
   - [ ] La proc√©dure de rollback est document√©e √©tape par √©tape
   - [ ] Le script de rollback est versionn√©

2. **Test rollback ex√©cut√©**
   - [ ] Le rollback a √©t√© ex√©cut√© sur environnement de test
   - [ ] Le synonyme PUBLIC UTL_FILE est supprim√©
   - [ ] Le package UTL_FILE_WRAPPER est supprim√©
   - [ ] La table de mapping est supprim√©e

3. **Recompilation**
   - [ ] Tous les sch√©mas impact√©s sont recompil√©s
   - [ ] Aucun objet n'est en statut INVALID

4. **Test UTL_FILE natif**
   - [ ] Apr√®s rollback, UTL_FILE natif (SYS.UTL_FILE) fonctionne
   - [ ] Un test √©criture/lecture fichier est OK

5. **Rapport**
   - [ ] Le rapport de test rollback est produit
   - [ ] Les r√©sultats sont document√©s

### ‚ùå NOT DONE si :
- Le rollback n'a pas √©t√© test√© sur environnement de test
- Des objets sont invalides apr√®s rollback
- UTL_FILE natif ne fonctionne pas apr√®s rollback</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>JIRA - Labels sugg√©r√©s</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>migration, exacc, utl_file, rollback, dba</code></pre>
        </div>
    </section>

    <!-- RECAPITULATIF -->
    <section style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); border: 2px solid #9c27b0;">
        <h2>üìä R√©capitulatif des tickets</h2>

        <table>
            <thead>
                <tr>
                    <th>N¬∞</th>
                    <th>Ticket</th>
                    <th>Type</th>
                    <th>Assign√© √†</th>
                    <th>D√©pendance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Audit UTL_FILE</td>
                    <td>Story</td>
                    <td>DBA</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Impl√©mentation Migration</td>
                    <td>Story</td>
                    <td>DBA</td>
                    <td>Ticket 1 + Config OCI</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Tests et Validation</td>
                    <td>Story</td>
                    <td>DBA + QA</td>
                    <td>Ticket 2</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Rollback et Test Rollback</td>
                    <td>Story</td>
                    <td>DBA</td>
                    <td>Ticket 2</td>
                </tr>
            </tbody>
        </table>

        <div class="alert alert-info" style="margin-top: 20px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Notes :</strong><br>
                - Le ticket "Configuration OCI" pour les admins cloud peut √™tre cr√©√© s√©par√©ment. Il est pr√©requis du Ticket 2.<br>
                - Les tickets 3 et 4 peuvent √™tre ex√©cut√©s en parall√®le apr√®s le ticket 2.
            </div>
        </div>
    </section>

</div>
<!-- ==================== FIN ONGLET JIRA ==================== -->

<!-- ==================== ONGLET GUIDE ==================== -->
<div id="guide" class="tab-content active">

    <!-- Info Multi-Sch√©mas -->
    <section style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border: 2px solid #4caf50;">
        <h2>üéØ Important : Migration Multi-Sch√©mas</h2>

        <div class="alert alert-success">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Connecte-toi √† chaque sch√©ma applicatif dans SQL Developer</strong><br>
                Les scripts utilisent <code>user_source</code> qui affiche automatiquement le code du sch√©ma connect√©. Pas besoin de modifier les scripts !
            </div>
        </div>

        <div class="alert alert-warning">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Ne migre que tes sch√©mas applicatifs !</strong><br>
                Les sch√©mas syst√®me Oracle (<code>SYS</code>, <code>SYSTEM</code>, <code>XDB</code>, etc.) sont g√©r√©s automatiquement par Oracle lors de la migration vers ExaCC. Tu ne dois jamais les modifier.
            </div>
        </div>

        <h3>üìã Proc√©dure pour chaque sch√©ma applicatif</h3>
        <div style="background: white; border-radius: 10px; padding: 20px; margin: 15px 0;">
            <ol style="padding-left: 20px; margin: 15px 0;">
                <li style="margin: 10px 0;"><strong>Dans SQL Developer :</strong> Cr√©e une connexion pour ton sch√©ma applicatif (ou utilise une existante)</li>
                <li style="margin: 10px 0;"><strong>Connecte-toi</strong> √† ce sch√©ma</li>
                <li style="margin: 10px 0;"><strong>Ex√©cute l'audit</strong> (le script utilise <code>user_source</code> = ton sch√©ma connect√©)</li>
                <li style="margin: 10px 0;"><strong>Note les r√©sultats</strong></li>
                <li style="margin: 10px 0;"><strong>R√©p√®te</strong> pour chaque sch√©ma applicatif</li>
            </ol>
        </div>

        <h3>üîç Script d'audit UTL_FILE (sch√©ma connect√©)</h3>
        <div class="alert alert-info">
            <span class="alert-icon">‚ö°</span>
            <div>
                <strong>Ex√©cute ce script dans SQL Developer</strong><br>
                Il analyse automatiquement le sch√©ma sur lequel tu es connect√©. Pas besoin de modifier le script !
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Audit UTL_FILE du sch√©ma connect√©</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- AUDIT UTL_FILE - SCH√âMA CONNECT√â
-- ============================================
-- Ex√©cute ce script connect√© √† ton sch√©ma applicatif dans SQL Developer
-- user_source = code source du sch√©ma sur lequel tu es connect√©

-- 1. Afficher le sch√©ma courant
SELECT USER AS schema_courant FROM DUAL;


-- 2. Nombre total de r√©f√©rences UTL_FILE dans ce sch√©ma
SELECT COUNT(*) AS total_references_utl_file
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%';


-- 3. D√©tail : quels objets utilisent UTL_FILE ?
SELECT
    name AS object_name,
    type AS object_type,
    COUNT(*) AS nb_lignes
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
GROUP BY name, type
ORDER BY nb_lignes DESC;


-- 4. Voir le code exact (lignes contenant UTL_FILE)
SELECT
    name AS object_name,
    type AS object_type,
    line AS numero_ligne,
    text AS code
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
ORDER BY name, type, line;


-- ============================================
-- 5. LISTER TOUTES LES FONCTIONS/CONSTANTES UTL_FILE UTILIS√âES
-- ============================================
-- Cette requ√™te identifie TOUTES les fonctions et constantes UTL_FILE
-- utilis√©es dans ton code pour v√©rifier si le wrapper les supporte

COLUMN fonction_utl_file FORMAT A40
COLUMN nb_utilisations FORMAT 9999
COLUMN supporte_wrapper FORMAT A20

SELECT
    fonction_utl_file,
    nb_utilisations,
    CASE
        WHEN UPPER(fonction_utl_file) IN (
            'UTL_FILE.FOPEN', 'UTL_FILE.FCLOSE', 'UTL_FILE.FCLOSE_ALL',
            'UTL_FILE.PUT_LINE', 'UTL_FILE.PUT', 'UTL_FILE.GET_LINE',
            'UTL_FILE.NEW_LINE', 'UTL_FILE.FFLUSH', 'UTL_FILE.IS_OPEN',
            'UTL_FILE.PUT_RAW', 'UTL_FILE.GET_RAW', 'UTL_FILE.FGETATTR',
            'UTL_FILE.FCOPY', 'UTL_FILE.FRENAME', 'UTL_FILE.FREMOVE',
            'UTL_FILE.FILE_TYPE',
            -- Constantes/Exceptions
            'UTL_FILE.INVALID_PATH', 'UTL_FILE.INVALID_MODE',
            'UTL_FILE.INVALID_FILEHANDLE', 'UTL_FILE.INVALID_OPERATION',
            'UTL_FILE.READ_ERROR', 'UTL_FILE.WRITE_ERROR',
            'UTL_FILE.INTERNAL_ERROR', 'UTL_FILE.INVALID_MAXLINESIZE',
            'UTL_FILE.INVALID_FILENAME', 'UTL_FILE.ACCESS_DENIED',
            'UTL_FILE.INVALID_OFFSET', 'UTL_FILE.DELETE_FAILED',
            'UTL_FILE.RENAME_FAILED'
        ) THEN '‚úÖ OUI'
        WHEN UPPER(fonction_utl_file) IN (
            'UTL_FILE.FSEEK', 'UTL_FILE.FGETPOS', 'UTL_FILE.PUTF'
        ) THEN '‚ùå NON'
        ELSE '‚ö†Ô∏è √Ä V√âRIFIER'
    END AS supporte_wrapper
FROM (
    SELECT
        REGEXP_SUBSTR(UPPER(text), 'UTL_FILE\.[A-Z_]+') AS fonction_utl_file,
        COUNT(*) AS nb_utilisations
    FROM user_source
    WHERE UPPER(text) LIKE '%UTL_FILE.%'
    GROUP BY REGEXP_SUBSTR(UPPER(text), 'UTL_FILE\.[A-Z_]+')
)
WHERE fonction_utl_file IS NOT NULL
ORDER BY nb_utilisations DESC;</code></pre>
        </div>

        <h3>üìä Connexion SYSDBA : Identifier les sch√©mas √† migrer</h3>
        <div class="alert alert-info">
            <span class="alert-icon">üîë</span>
            <div>
                <strong>Connect√© en SYSDBA ?</strong><br>
                Utilise ces commandes pour identifier rapidement tous les sch√©mas qui utilisent UTL_FILE.
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Lister tous les sch√©mas utilisant UTL_FILE (SYSDBA)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- LISTER LES SCH√âMAS UTILISANT UTL_FILE
-- ============================================
-- Ex√©cute connect√© en SYSDBA (sqlplus / as sysdba)

-- Formatage pour affichage lisible dans SQL*Plus
SET LINESIZE 200
SET PAGESIZE 100
COLUMN schema_name FORMAT A30
COLUMN nb_references FORMAT 999999

-- 1. Liste simple des sch√©mas
SELECT DISTINCT owner AS schema_name
FROM dba_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
  AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM', 'XDB', 'WMSYS')
ORDER BY owner;


-- 2. Avec le nombre de r√©f√©rences par sch√©ma
SELECT owner AS schema_name, COUNT(*) AS nb_references
FROM dba_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
  AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM', 'XDB', 'WMSYS')
GROUP BY owner
ORDER BY nb_references DESC;</code></pre>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Lister tous les sch√©mas de la base (SYSDBA)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- Formatage pour affichage lisible dans SQL*Plus
SET LINESIZE 200
SET PAGESIZE 100
COLUMN username FORMAT A30

-- Lister tous les sch√©mas (utilisateurs) de la base
SELECT username FROM dba_users ORDER BY username;

-- Lister uniquement les sch√©mas applicatifs (sans sch√©mas syst√®me)
SELECT username
FROM dba_users
WHERE username NOT IN (
    'SYS', 'SYSTEM', 'ORACLE_OCM', 'XDB', 'WMSYS', 'CTXSYS', 'MDSYS',
    'OLAPSYS', 'ORDDATA', 'ORDSYS', 'OUTLN', 'DBSNMP', 'APPQOSSYS',
    'DBSFWUSER', 'GGSYS', 'ANONYMOUS', 'AUDSYS', 'DIP', 'DVF', 'DVSYS',
    'GSMADMIN_INTERNAL', 'GSMCATUSER', 'GSMUSER', 'LBACSYS', 'OJVMSYS',
    'REMOTE_SCHEDULER_AGENT', 'SYS$UMF', 'SYSBACKUP', 'SYSDG', 'SYSKM', 'SYSRAC'
)
  AND username NOT LIKE 'APEX%'
  AND username NOT LIKE 'FLOWS_%'
  AND username NOT LIKE 'OWA%'
  AND account_status = 'OPEN'
ORDER BY username;</code></pre>
        </div>
    </section>

    <!-- R√©partition des r√¥les -->
    <section>
        <h2>üë• R√©partition des R√¥les</h2>

        <div class="alert alert-success">
            <span class="alert-icon">‚úÖ</span>
            <div>
                <strong>Bonne nouvelle !</strong><br>
                Tu n'as pas besoin de g√©rer les API Keys, les buckets ou les policies OCI. Les admins cloud s'en occupent.
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>T√¢che</th>
                    <th>Qui ?</th>
                    <th>Statut</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Cr√©er le bucket Object Storage</td>
                    <td><span class="tag tag-admin">Admin OCI</span></td>
                    <td>√Ä demander</td>
                </tr>
                <tr>
                    <td>G√©n√©rer les API Keys</td>
                    <td><span class="tag tag-admin">Admin OCI</span></td>
                    <td>√Ä demander</td>
                </tr>
                <tr>
                    <td>Configurer les IAM Policies</td>
                    <td><span class="tag tag-admin">Admin OCI</span></td>
                    <td>√Ä demander</td>
                </tr>
                <tr>
                    <td>Cr√©er le credential DBMS_CLOUD en base</td>
                    <td><span class="tag tag-admin">Admin OCI</span> ou <span class="tag tag-toi">Toi</span></td>
                    <td>√Ä clarifier</td>
                </tr>
                <tr>
                    <td>Configurer les ACL r√©seau</td>
                    <td><span class="tag tag-admin">Admin OCI</span></td>
                    <td>√Ä demander</td>
                </tr>
                <tr style="background: #e6f4ea;">
                    <td><strong>Audit du code UTL_FILE</strong></td>
                    <td><span class="tag tag-toi">Toi (DBA)</span></td>
                    <td>√Ä faire maintenant</td>
                </tr>
                <tr style="background: #e6f4ea;">
                    <td><strong>Cr√©er la table de mapping</strong></td>
                    <td><span class="tag tag-toi">Toi (DBA)</span></td>
                    <td>Apr√®s retour admins</td>
                </tr>
                <tr style="background: #e6f4ea;">
                    <td><strong>D√©ployer le package wrapper</strong></td>
                    <td><span class="tag tag-toi">Toi (DBA)</span></td>
                    <td>Apr√®s retour admins</td>
                </tr>
                <tr style="background: #e6f4ea;">
                    <td><strong>Remplacer UTL_FILE dans le code</strong></td>
                    <td><span class="tag tag-toi">Toi (DBA)</span></td>
                    <td>Apr√®s wrapper</td>
                </tr>
                <tr style="background: #e6f4ea;">
                    <td><strong>Tests de validation</strong></td>
                    <td><span class="tag tag-toi">Toi (DBA)</span></td>
                    <td>Final</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Email aux admins -->
    <section>
        <h2>üìß Email √† envoyer aux Admins OCI</h2>

        <div class="alert alert-info">
            <span class="alert-icon">üì®</span>
            <div>
                <strong>Premi√®re √©tape</strong><br>
                Envoie cet email aux admins OCI pour obtenir les informations n√©cessaires.
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>Email - Demande aux admins OCI</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>Objet : [Migration ExaCC] Demande configuration Object Storage pour remplacement UTL_FILE

Bonjour,

Dans le cadre de la migration vers ExaCC, nous devons remplacer les appels
UTL_FILE par DBMS_CLOUD + Object Storage car l'acc√®s au filesystem local
n'est plus disponible sur ExaCC.

Apr√®s audit, nous avons identifi√© plus de 1000 utilisations de UTL_FILE
dans notre base de donn√©es.

Pourriez-vous nous fournir les √©l√©ments suivants :

1. URI DU BUCKET OBJECT STORAGE
   Format attendu :
   https://objectstorage.[region].oraclecloud.com/n/[namespace]/b/[bucket]/o/

   Exemple : https://objectstorage.eu-paris-1.oraclecloud.com/n/monnamespace/b/db-files/o/

2. NOM DU CREDENTIAL DBMS_CLOUD
   Le credential doit √™tre cr√©√© dans la base de donn√©es pour permettre
   l'authentification vers Object Storage.

   Question : Ce credential est-il d√©j√† cr√©√© ? Si oui, quel est son nom ?
   Sinon, pouvez-vous le cr√©er ou me fournir les informations (API Key)
   pour que je le cr√©e ?

3. CONFIRMATION DES ACL R√âSEAU
   La base doit pouvoir acc√©der √† *.oraclecloud.com sur le port 443 (HTTPS).
   Pouvez-vous confirmer que c'est configur√© ?

4. DOSSIERS (PREFIXES) √Ä CR√âER DANS LE BUCKET
   Voici la liste des directories Oracle actuels √† migrer :

   [LISTE √Ä COMPL√âTER APR√àS AUDIT - voir ci-dessous]

Merci de me tenir inform√© d√®s que ces √©l√©ments seront disponibles.

Cordialement,
[Ton nom]</code></pre>
        </div>

        <h3>üìã Liste des directories √† inclure dans l'email</h3>
        <p>Ex√©cute d'abord l'audit pour obtenir la liste :</p>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Lister les directories utilis√©s par UTL_FILE</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- Lister les directories applicatifs (hors directories syst√®me Oracle)
SELECT directory_name, directory_path
FROM all_directories
WHERE directory_name NOT LIKE 'ORACLE%'
  AND directory_name NOT LIKE 'OPATCH%'
  AND directory_name NOT LIKE 'DATA_PUMP%'
  AND directory_name NOT LIKE 'DBMS_%'
  AND directory_name NOT LIKE 'XDB%'
  AND directory_name NOT LIKE 'XML%'
  AND directory_name NOT LIKE 'XSD%'
  AND directory_name NOT LIKE 'JAVA$%'
  AND directory_name NOT LIKE 'ADMIN%'
ORDER BY directory_name;</code></pre>
        </div>
    </section>

    <!-- √âtape 1.5 : Identifier les directories -->
    <section>
        <h2>üìÅ √âtape 1.5 : Identifier les Dossiers √† Cr√©er dans Object Storage</h2>

        <div class="alert alert-info">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Principe important</strong><br>
                Les dossiers (prefixes) √† cr√©er dans le bucket Object Storage sont <strong>les m√™mes noms</strong> que tes directories Oracle actuels. Ainsi, ton code n'a pas besoin de changer !
            </div>
        </div>

        <div style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 15px; padding: 25px; margin: 20px 0; border: 2px solid #2196f3;">
            <h3 style="margin-top: 0; color: #1565c0;">üîÑ Correspondance Directory Oracle ‚Üí Dossier Object Storage</h3>
            <table style="width: 100%; margin: 15px 0; background: white; border-radius: 10px;">
                <thead>
                    <tr>
                        <th style="background: #1565c0; color: white; padding: 12px;">Avant (On-Premise)</th>
                        <th style="background: #1565c0; color: white; padding: 12px;">Apr√®s (Object Storage)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            <code>UTL_FILE.FOPEN('<strong>DATA_EXPORT</strong>', 'fichier.txt')</code><br>
                            <small style="color: #666;">Directory ‚Üí /u01/app/data/</small>
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            Fichier stock√© dans : <code>bucket/<strong>DATA_EXPORT</strong>/fichier.txt</code>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            <code>UTL_FILE.FOPEN('<strong>LOG_DIR</strong>', 'batch.log')</code><br>
                            <small style="color: #666;">Directory ‚Üí /u01/app/logs/</small>
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            Fichier stock√© dans : <code>bucket/<strong>LOG_DIR</strong>/batch.log</code>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            <code>UTL_FILE.FOPEN('<strong>REPORTS</strong>', 'rapport.pdf')</code><br>
                            <small style="color: #666;">Directory ‚Üí /u01/app/reports/</small>
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            Fichier stock√© dans : <code>bucket/<strong>REPORTS</strong>/rapport.pdf</code>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p style="margin: 0; text-align: center; font-style: italic; color: #1565c0;">
                <strong>Le nom du directory Oracle devient le nom du dossier dans le bucket !</strong>
            </p>
        </div>

        <h3>üîç Script : Lister les directories √† migrer</h3>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Lister tous les directories applicatifs</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- LISTER TOUS LES DIRECTORIES ORACLE
-- ============================================
-- Formatage pour affichage lisible
SET LINESIZE 200
SET PAGESIZE 100
COLUMN directory_name FORMAT A30
COLUMN directory_path FORMAT A60

-- Liste les directories applicatifs (hors directories syst√®me Oracle)
SELECT
    directory_name,
    directory_path
FROM all_directories
WHERE directory_name NOT LIKE 'ORACLE%'
  AND directory_name NOT LIKE 'OPATCH%'
  AND directory_name NOT LIKE 'DATA_PUMP%'
  AND directory_name NOT LIKE 'DBMS_%'
  AND directory_name NOT LIKE 'XDB%'
  AND directory_name NOT LIKE 'XML%'
  AND directory_name NOT LIKE 'XSD%'
  AND directory_name NOT LIKE 'JAVA$%'
  AND directory_name NOT LIKE 'ADMIN%'
ORDER BY directory_name;</code></pre>
        </div>

        <div class="alert alert-info">
            <span class="alert-icon">üìã</span>
            <div>
                <strong>√âtape suivante</strong><br>
                Avec cette liste, valide avec l'√©quipe applicative quels directories sont r√©ellement utilis√©s par les traitements UTL_FILE.<br>
                Ces directories deviendront les dossiers (prefixes) √† cr√©er dans le bucket Object Storage.
            </div>
        </div>

        <h3>üìß Mod√®le d'email √† envoyer √† un √©diteur de logiciel</h3>

        <div class="alert alert-info">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Quand utiliser ce mail ?</strong><br>
                Si tu utilises une application tierce (√©diteur) qui partage ta base de donn√©es, envoie ce mail pour v√©rifier la compatibilit√©.
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>Email - V√©rification compatibilit√© √©diteur</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>Objet : Migration Oracle ExaCC - V√©rification compatibilit√© de votre application

Bonjour,

Dans le cadre de la modernisation de notre infrastructure, nous allons migrer notre base de donn√©es Oracle vers Oracle Exadata Cloud@Customer (ExaCC).

CHANGEMENT TECHNIQUE MAJEUR :

Sur ExaCC, l'acc√®s direct au syst√®me de fichiers du serveur de base de donn√©es est supprim√©. Concr√®tement, le package Oracle UTL_FILE (utilis√© pour lire/√©crire des fichiers c√¥t√© serveur BDD) n'est plus disponible.

IMPACT POTENTIEL :

Les applications qui g√©n√®rent ou lisent des fichiers directement c√¥t√© base de donn√©es via PL/SQL (exports CSV, fichiers de logs, fichiers d'interface, etc.) sont concern√©es.

En revanche, si votre application g√®re les fichiers c√¥t√© serveur applicatif (Java, .NET, PHP...) apr√®s avoir r√©cup√©r√© les donn√©es en SQL, il n'y a aucun impact.

DIRECTORIES ORACLE EXISTANTS :

Voici la liste des directories Oracle actuellement configur√©s sur notre base :

   - DIR_EXPORT      ‚Üí /u01/app/oracle/exports/
   - DIR_LOGS        ‚Üí /u01/app/oracle/logs/
   - DIR_INTERFACE   ‚Üí /u01/app/oracle/interface/
   [Adapter selon le r√©sultat de votre requ√™te all_directories]

NOTRE DEMANDE :

Parmi ces directories, lesquels sont utilis√©s par votre application ?

Si votre application utilise UTL_FILE, merci de nous indiquer :
- Les fonctionnalit√©s concern√©es (exports, interfaces, logs...)
- Les directories utilis√©s parmi la liste ci-dessus
- Ou les chemins physiques si cod√©s en dur dans votre code
- Si vous disposez d'une version compatible Cloud/ExaCC

Nous restons disponibles pour en discuter.

Cordialement,
[Votre nom]</code></pre>
        </div>

        <h3>üìß Exemple de liste √† envoyer aux admins OCI</h3>

        <div style="background: #f8f9fa; border: 2px dashed #6c757d; border-radius: 10px; padding: 20px; margin: 20px 0; font-family: 'Courier New', monospace;">
            <p style="margin: 0 0 15px 0; font-weight: bold; color: #495057;">Dossiers (prefixes) √† cr√©er dans le bucket Object Storage :</p>
            <pre style="background: transparent; margin: 0; padding: 0; color: #212529;">
   - DATA_EXPORT/
   - LOG_DIR/
   - REPORTS/
   - BACKUP_DIR/
   - INTERFACE_IN/
   - INTERFACE_OUT/
   [Adapter selon le r√©sultat de ton audit]</pre>
        </div>

        <div class="alert alert-success">
            <span class="alert-icon">‚úÖ</span>
            <div>
                <strong>R√©sultat attendu</strong><br>
                Apr√®s cr√©ation par les admins OCI, le bucket aura cette structure :
                <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; margin-top: 10px;">
mon-bucket/
‚îú‚îÄ‚îÄ DATA_EXPORT/
‚îÇ   ‚îî‚îÄ‚îÄ (tes fichiers d'export iront ici)
‚îú‚îÄ‚îÄ LOG_DIR/
‚îÇ   ‚îî‚îÄ‚îÄ (tes logs iront ici)
‚îú‚îÄ‚îÄ REPORTS/
‚îÇ   ‚îî‚îÄ‚îÄ (tes rapports iront ici)
‚îî‚îÄ‚îÄ ...</pre>
            </div>
        </div>

        <div class="alert alert-warning">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Important</strong><br>
                Les noms des dossiers dans Object Storage doivent √™tre <strong>exactement identiques</strong> aux noms des directories Oracle (en majuscules g√©n√©ralement). Sinon la table de mapping ne fera pas la correspondance !
            </div>
        </div>

    </section>

    <!-- Ton plan d'action -->
    <section>
        <h2>üìã Ton Plan d'Action (5 √©tapes)</h2>

        <div class="progress-bar">
            <div class="progress-fill" style="width: 20%;" id="progress"></div>
        </div>
        <p style="text-align: center; color: var(--gray);">Progression : <span id="progress-text">√âtape 1/5</span></p>

        <ul class="checklist">
            <!-- √âTAPE 1 -->
            <li class="pending">
                <span class="step-number">1</span>
                <div>
                    <strong>Audit UTL_FILE</strong> <span class="tag tag-toi">√Ä faire maintenant</span><br>
                    <small>Identifier toutes les utilisations de UTL_FILE dans la base. Tu peux commencer sans attendre les admins OCI.</small>
                </div>
            </li>
        </ul>
        <div class="alert alert-info" style="margin: 0 0 20px 45px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Pourquoi cette √©tape ?</strong><br>
                <p style="margin: 10px 0;">Imagine que tu d√©m√©nages d'une maison vers un appartement. Avant de commencer, tu dois <strong>inventorier tout ce que tu poss√®des</strong> pour savoir ce qui rentrera et ce qu'il faudra adapter.</p>
                <p style="margin: 10px 0;">C'est pareil ici : UTL_FILE c'est ton "ancienne m√©thode" pour lire/√©crire des fichiers sur le serveur. Sur ExaCC, cette m√©thode ne fonctionne plus. Tu dois donc <strong>lister tous les endroits du code</strong> o√π cette m√©thode est utilis√©e pour savoir exactement ce qu'il faudra modifier.</p>
                <p style="margin: 10px 0;"><strong>Analogie :</strong> C'est comme faire le tour de ta maison avec un carnet pour noter tous les meubles avant le d√©m√©nagement.</p>
            </div>
        </div>

        <ul class="checklist">
            <!-- √âTAPE 2 -->
            <li class="blocked">
                <span class="step-number">2</span>
                <div>
                    <strong>Envoyer l'email aux admins OCI</strong> <span class="tag tag-attente">Bloquant</span><br>
                    <small>Demander : URI bucket, nom du credential, confirmation ACL.</small>
                </div>
            </li>
        </ul>
        <div class="alert alert-info" style="margin: 0 0 20px 45px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Pourquoi cette √©tape ?</strong><br>
                <p style="margin: 10px 0;">Tu as besoin de <strong>3 informations cl√©s</strong> que seuls les admins OCI peuvent te donner :</p>
                <ul style="margin: 10px 0 10px 20px;">
                    <li><strong>URI du bucket</strong> = l'adresse du nouveau "disque dur cloud" o√π seront stock√©s tes fichiers</li>
                    <li><strong>Credential</strong> = le "mot de passe" que la base utilisera pour acc√©der √† ce disque cloud</li>
                    <li><strong>ACL</strong> = l'autorisation r√©seau pour que ta base puisse communiquer avec le cloud</li>
                </ul>
                <p style="margin: 10px 0;"><strong>Analogie :</strong> C'est comme demander √† ton nouveau propri√©taire l'adresse exacte, les cl√©s et le code du digicode avant de d√©m√©nager.</p>
            </div>
        </div>

        <ul class="checklist">
            <!-- √âTAPE 3 -->
            <li class="blocked">
                <span class="step-number">3</span>
                <div>
                    <strong>Cr√©er la table de mapping</strong> <span class="tag tag-attente">Attente retour admins</span><br>
                    <small>Apr√®s r√©ception de l'URI du bucket, cr√©er la table de correspondance directory ‚Üí Object Storage.</small>
                </div>
            </li>
        </ul>
        <div class="alert alert-info" style="margin: 0 0 20px 45px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Pourquoi cette √©tape ?</strong><br>
                <p style="margin: 10px 0;">Ton ancien code utilise des <strong>"directories Oracle"</strong> comme <code>DATA_EXPORT</code> ou <code>LOG_DIR</code>. Ce sont des raccourcis vers des dossiers sur le serveur (ex: <code>/u01/app/data</code>).</p>
                <p style="margin: 10px 0;">Sur ExaCC, ces dossiers n'existent plus. La table de mapping fait la <strong>traduction</strong> entre l'ancien chemin et le nouveau chemin cloud :</p>
                <table style="margin: 10px 0; font-size: 0.9rem;">
                    <tr><td style="padding: 5px 10px; background: #fce8e6;"><code>DATA_EXPORT</code></td><td style="padding: 5px;">‚Üí</td><td style="padding: 5px 10px; background: #e6f4ea;"><code>https://objectstorage.../DATA_EXPORT/</code></td></tr>
                    <tr><td style="padding: 5px 10px; background: #fce8e6;"><code>LOG_DIR</code></td><td style="padding: 5px;">‚Üí</td><td style="padding: 5px 10px; background: #e6f4ea;"><code>https://objectstorage.../LOG_DIR/</code></td></tr>
                </table>
                <p style="margin: 10px 0;"><strong>Analogie :</strong> C'est comme cr√©er un tableau de correspondance "ancienne adresse ‚Üí nouvelle adresse" pour faire suivre ton courrier apr√®s un d√©m√©nagement.</p>
            </div>
        </div>

        <ul class="checklist">
            <!-- √âTAPE 4 -->
            <li class="blocked">
                <span class="step-number">4</span>
                <div>
                    <strong>D√©ployer le package wrapper</strong> <span class="tag tag-attente">Attente retour admins</span><br>
                    <small>Installer UTL_FILE_WRAPPER qui utilise DBMS_CLOUD en arri√®re-plan.</small>
                </div>
            </li>
        </ul>
        <div class="alert alert-info" style="margin: 0 0 20px 45px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Pourquoi cette √©tape ?</strong><br>
                <p style="margin: 10px 0;">Le <strong>wrapper</strong> est un "traducteur" intelligent. Il permet √† ton ancien code de continuer √† fonctionner <strong>sans le modifier</strong>.</p>
                <p style="margin: 10px 0;"><strong>Comment √ßa marche :</strong></p>
                <ul style="margin: 10px 0 10px 20px;">
                    <li>Ton code appelle <code>UTL_FILE.FOPEN('DATA_EXPORT', 'fichier.txt')</code> comme avant</li>
                    <li>Le wrapper intercepte cet appel</li>
                    <li>Il consulte la table de mapping pour trouver l'URL cloud correspondante</li>
                    <li>Il utilise <code>DBMS_CLOUD</code> pour envoyer le fichier vers Object Storage</li>
                    <li>Ton code ne voit aucune diff√©rence !</li>
                </ul>
                <p style="margin: 10px 0;"><strong>Analogie :</strong> C'est comme un adaptateur √©lectrique quand tu voyages. Ta prise fran√ßaise fonctionne toujours, l'adaptateur fait la conversion vers la prise √©trang√®re.</p>
            </div>
        </div>

        <ul class="checklist">
            <!-- √âTAPE 5 -->
            <li class="blocked">
                <span class="step-number">5</span>
                <div>
                    <strong>Cr√©er le synonyme et tester</strong> <span class="tag tag-attente">Apr√®s √©tape 4</span><br>
                    <small>Cr√©er le synonyme UTL_FILE ‚Üí UTL_FILE_WRAPPER et valider avec un test complet.</small>
                </div>
            </li>
        </ul>
        <div class="alert alert-info" style="margin: 0 0 20px 45px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Pourquoi cette √©tape ?</strong><br>
                <p style="margin: 10px 0;">C'est le moment de <strong>brancher l'adaptateur</strong> avec le <strong>synonyme</strong> :</p>
                <ul style="margin: 10px 0 10px 20px;">
                    <li>Tu cr√©es un "alias" : quand le code dit <code>UTL_FILE</code>, Oracle comprend <code>UTL_FILE_WRAPPER</code></li>
                    <li>Avantage : <strong>z√©ro modification</strong> de ton code existant</li>
                    <li>Avec 1000+ utilisations, c'est la seule m√©thode viable et sans risque</li>
                </ul>
                <p style="margin: 10px 0;">Ensuite, tu <strong>testes</strong> que tout fonctionne : √©criture d'un fichier test, lecture, suppression. Si √ßa marche, la migration est termin√©e !</p>
                <p style="margin: 10px 0;"><strong>Analogie :</strong> C'est comme tester l'√©lectricit√© dans ton nouvel appartement apr√®s avoir tout branch√©.</p>
            </div>
        </div>

    </section>

    <!-- Architecture et Flux -->
    <section>
        <h2>üèóÔ∏è Comprendre l'Architecture : Avant / Apr√®s</h2>

        <div class="alert alert-info">
            <span class="alert-icon">üìç</span>
            <div>
                <strong>Ton contexte : Migration On-Premise ‚Üí ExaCC</strong><br>
                Ta base de donn√©es est actuellement sur un serveur physique (On-Premise) et va √™tre migr√©e vers ExaCC dans le cloud OCI.
            </div>
        </div>

        <!-- AVANT : On-Premise -->
        <h3>üè† AVANT : Comment √ßa marche aujourd'hui (On-Premise)</h3>

        <div style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-radius: 15px; padding: 25px; margin: 20px 0; border: 2px solid #ff9800;">
            <pre style="background: transparent; color: #333; font-family: 'Courier New', monospace; font-size: 0.95rem; line-height: 1.8; margin: 0; overflow-x: auto;">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  üè¢ TON SERVEUR ACTUEL (On-Premise)             ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                           ‚îÇ
‚îÇ   ‚îÇ  üìù Code PL/SQL ‚îÇ                                           ‚îÇ
‚îÇ   ‚îÇ                 ‚îÇ                                           ‚îÇ
‚îÇ   ‚îÇ  UTL_FILE.FOPEN ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                 ‚îÇ
‚îÇ   ‚îÇ  ('DATA_EXPORT',‚îÇ         ‚îÇ                                 ‚îÇ
‚îÇ   ‚îÇ   'fichier.txt')‚îÇ         ‚îÇ  Acc√®s DIRECT au disque         ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ                                 ‚îÇ
‚îÇ                               ‚ñº                                 ‚îÇ
‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îÇ
‚îÇ              ‚îÇ  üíæ DISQUE DUR DU SERVEUR          ‚îÇ             ‚îÇ
‚îÇ              ‚îÇ                                    ‚îÇ             ‚îÇ
‚îÇ              ‚îÇ  üìÅ /u01/app/oracle/data/          ‚îÇ             ‚îÇ
‚îÇ              ‚îÇ     ‚îú‚îÄ‚îÄ üìÑ export_20240115.csv     ‚îÇ             ‚îÇ
‚îÇ              ‚îÇ     ‚îú‚îÄ‚îÄ üìÑ rapport_mensuel.txt     ‚îÇ             ‚îÇ
‚îÇ              ‚îÇ     ‚îî‚îÄ‚îÄ üìÑ log_batch.txt           ‚îÇ             ‚îÇ
‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            </pre>
            <div style="margin-top: 15px; padding: 15px; background: white; border-radius: 10px;">
                <strong>üí° Explication simple :</strong>
                <p style="margin: 10px 0;">Aujourd'hui, quand ton code fait <code>UTL_FILE.FOPEN('DATA_EXPORT', 'fichier.txt')</code>, Oracle va directement √©crire sur le disque dur du serveur, dans un dossier comme <code>/u01/app/oracle/data/</code>.</p>
                <p style="margin: 5px 0;"><strong>Analogie :</strong> C'est comme √©crire un document et le sauvegarder sur le disque dur de ton PC. Simple et direct.</p>
            </div>
        </div>

        <!-- APR√àS : ExaCC -->
        <h3>‚òÅÔ∏è APR√àS : Comment √ßa marchera sur ExaCC</h3>

        <!-- Pourquoi migrer vers ExaCC -->
        <div style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); border-radius: 15px; padding: 25px; margin: 20px 0; border: 2px solid #9c27b0;">
            <h4 style="margin-top: 0; color: #6a1b9a;">üéØ Pourquoi migrer vers ExaCC ?</h4>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                <div style="background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #4caf50;">
                    <strong style="color: #2e7d32;">üí∞ R√©duction des co√ªts</strong>
                    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">Plus besoin de g√©rer le mat√©riel, la climatisation, l'√©lectricit√© du datacenter. Oracle s'en occupe.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #2196f3;">
                    <strong style="color: #1565c0;">üîß Maintenance simplifi√©e</strong>
                    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">Les patchs, mises √† jour et maintenance mat√©rielle sont g√©r√©s par Oracle. Tu te concentres sur la base.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #ff9800;">
                    <strong style="color: #e65100;">üìà Scalabilit√©</strong>
                    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">Besoin de plus de puissance ? Tu augmentes les ressources en quelques clics, sans acheter de nouveau serveur.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #f44336;">
                    <strong style="color: #c62828;">üõ°Ô∏è Haute disponibilit√©</strong>
                    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">R√©plication automatique, backups g√©r√©s par Oracle, reprise apr√®s sinistre facilit√©e.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #9c27b0;">
                    <strong style="color: #6a1b9a;">üîí S√©curit√© renforc√©e</strong>
                    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">Chiffrement automatique, isolation r√©seau, conformit√© aux normes (RGPD, etc.).</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 15px; border-left: 4px solid #00bcd4;">
                    <strong style="color: #00838f;">üè† Donn√©es chez toi</strong>
                    <p style="margin: 10px 0 0 0; font-size: 0.9rem;">Avec ExaCC, l'infrastructure est dans TON datacenter. Tu gardes le contr√¥le physique de tes donn√©es.</p>
                </div>
            </div>
        </div>

        <!-- Diff√©rence On-Premise vs ExaCC -->
        <div style="background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%); border-radius: 15px; padding: 25px; margin: 20px 0; border: 2px solid #ffc107;">
            <h4 style="margin-top: 0; color: #f57f17;">üÜö Oracle On-Premise vs ExaCC : Quelle diff√©rence ?</h4>

            <table style="width: 100%; margin: 15px 0; background: white; border-radius: 10px; border-collapse: collapse;">
                <thead>
                    <tr>
                        <th style="background: #f57f17; color: white; padding: 15px; text-align: left; width: 25%;">Crit√®re</th>
                        <th style="background: #ff8f00; color: white; padding: 15px; text-align: center;">Oracle On-Premise (Actuel)</th>
                        <th style="background: #4caf50; color: white; padding: 15px; text-align: center;">ExaCC (Cible)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">üñ•Ô∏è Infrastructure</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Serveurs Linux classiques<br><small style="color: #666;">Tu installes Oracle dessus</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">Exadata (appliance optimis√©e)<br><small style="color: #666;">Mat√©riel + logiciel int√©gr√©</small></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">üìç O√π est le mat√©riel ?</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Dans ton datacenter<br><small style="color: #666;">Tu ach√®tes et g√®res tout</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">Dans ton datacenter<br><small style="color: #666;">Oracle installe et g√®re</small></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">üíµ Mod√®le de co√ªt</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">CAPEX (achat serveurs + licences)<br><small style="color: #666;">Investissement initial</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">OPEX (abonnement)<br><small style="color: #666;">Paiement mensuel/annuel</small></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">üîß Qui g√®re quoi ?</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Toi : serveurs, OS, Oracle, patchs<br><small style="color: #666;">Charge op√©rationnelle √©lev√©e</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">Oracle : mat√©riel, OS, patchs<br>Toi : bases de donn√©es uniquement</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">‚ö° Performance</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">D√©pend de ton mat√©riel<br><small style="color: #666;">Variable selon config</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">Optimis√©e pour Oracle<br><small style="color: #666;">Smart Scan, InfiniBand, etc.</small></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">üìÅ Acc√®s filesystem</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">OUI (UTL_FILE)<br><small style="color: #666;">Acc√®s direct /u01/...</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #ffebee;">NON ‚ùå<br><small style="color: #c62828;">‚Üí Object Storage + DBMS_CLOUD</small></td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">‚òÅÔ∏è Services cloud OCI</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">Non disponible<br><small style="color: #666;">Isol√© du cloud</small></td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; background: #e8f5e9;">Int√©gr√© nativement<br><small style="color: #666;">Object Storage, IAM, backups...</small></td>
                    </tr>
                </tbody>
            </table>

            <div style="background: white; border-radius: 10px; padding: 20px; margin-top: 15px; border-left: 5px solid #f57f17;">
                <strong>üí° En r√©sum√© simple (pour expliquer comme un pro) :</strong>

                <div style="margin: 15px 0; padding: 15px; background: #fff3e0; border-radius: 10px;">
                    <p style="margin: 0 0 10px 0;"><strong>üêß Actuellement : Oracle sur serveurs Linux On-Premise</strong></p>
                    <p style="margin: 0; padding-left: 15px;">
                        Vos bases Oracle sont install√©es sur des <strong>serveurs Linux classiques</strong> dans votre datacenter.
                        Vous g√©rez tout : le mat√©riel (serveurs, stockage, r√©seau), le syst√®me d'exploitation Linux,
                        l'installation d'Oracle, les patchs de s√©curit√©, les sauvegardes, etc.
                        C'est un mod√®le <strong>CAPEX</strong> (investissement) avec un contr√¥le total mais une <strong>charge op√©rationnelle importante</strong>.
                    </p>
                </div>

                <div style="margin: 15px 0; padding: 15px; background: #e8f5e9; border-radius: 10px;">
                    <p style="margin: 0 0 10px 0;"><strong>‚òÅÔ∏è Cible : ExaCC (Exadata Cloud@Customer)</strong></p>
                    <p style="margin: 0; padding-left: 15px;">
                        <strong>Exadata</strong> est une appliance Oracle : du mat√©riel sp√©cialement con√ßu et optimis√© pour faire tourner Oracle Database
                        (stockage flash, r√©seau InfiniBand, Smart Scan, etc.). C'est la <strong>Rolls-Royce des infrastructures Oracle</strong>.<br><br>
                        <strong>Cloud@Customer</strong> signifie qu'Oracle installe cette Exadata <strong>physiquement dans votre datacenter</strong>,
                        mais c'est <strong>Oracle qui la g√®re</strong> (maintenance, patchs, monitoring mat√©riel).<br><br>
                        Vous passez en mod√®le <strong>OPEX</strong> (abonnement) et vous vous concentrez uniquement sur vos <strong>bases de donn√©es</strong> (sch√©mas, donn√©es, PL/SQL).
                        Vos donn√©es restent chez vous = <strong>souverainet√© des donn√©es</strong> garantie.
                    </p>
                </div>

                <div style="margin: 15px 0; padding: 15px; background: #e3f2fd; border-radius: 10px;">
                    <p style="margin: 0 0 10px 0;"><strong>üéØ La diff√©rence cl√© en une phrase :</strong></p>
                    <p style="margin: 0; padding-left: 15px; font-size: 1.05rem;">
                        <em>"On passe de <strong>serveurs Linux classiques qu'on g√®re nous-m√™mes</strong> √† une <strong>infrastructure Exadata manag√©e par Oracle</strong>,
                        install√©e chez nous. On gagne en performance, en fiabilit√© et on r√©duit notre charge op√©rationnelle,
                        tout en gardant nos donn√©es dans notre datacenter."</em>
                    </p>
                </div>

                <div style="margin: 15px 0; padding: 15px; background: #fce4ec; border-radius: 10px; border: 2px solid #e91e63;">
                    <p style="margin: 0 0 10px 0;"><strong>‚ö†Ô∏è Impact technique majeur pour le DBA :</strong></p>
                    <p style="margin: 0; padding-left: 15px;">
                        Sur ExaCC, tu n'as <strong>plus d'acc√®s au filesystem</strong> du serveur (pas de SSH sur /u01/app/...).
                        Les packages comme <code>UTL_FILE</code> qui √©crivent sur le disque local ne fonctionnent plus.<br><br>
                        Tu dois utiliser <strong>Object Storage</strong> (stockage objet OCI) via le package <strong>DBMS_CLOUD</strong> pour toutes les op√©rations fichiers.
                        <br><br>
                        <strong>üëâ C'est exactement l'objet de cette migration :</strong> adapter ton code PL/SQL pour qu'il fonctionne sur ExaCC.
                    </p>
                </div>

                <div style="margin: 15px 0; padding: 15px; background: #f5f5f5; border-radius: 10px; border: 1px solid #9e9e9e;">
                    <p style="margin: 0 0 10px 0;"><strong>üìù Script pour expliquer √† un coll√®gue ou manager :</strong></p>
                    <p style="margin: 0; padding: 10px; background: white; border-radius: 8px; font-style: italic; line-height: 1.8;">
                        "Actuellement, nos bases Oracle tournent sur des <strong>serveurs Linux classiques</strong> qu'on g√®re nous-m√™mes (mat√©riel, OS, patchs, etc.).<br><br>
                        On migre vers <strong>ExaCC (Exadata Cloud@Customer)</strong>. C'est une infrastructure <strong>Exadata</strong> ‚Äî du mat√©riel haute performance sp√©cialement con√ßu pour Oracle ‚Äî qu'Oracle va installer <strong>dans notre datacenter</strong>. Mais c'est <strong>Oracle qui g√®re l'infrastructure</strong> (maintenance, patchs, monitoring). Nous, on se concentre uniquement sur nos bases de donn√©es.<br><br>
                        <strong>Les avantages :</strong> meilleures performances, moins de charge op√©rationnelle, mod√®le OPEX (abonnement au lieu d'achat), services cloud OCI int√©gr√©s, et nos donn√©es restent physiquement chez nous.<br><br>
                        <strong>La contrainte technique :</strong> on perd l'acc√®s direct au filesystem du serveur. Donc tout notre code qui utilise <strong>UTL_FILE</strong> pour lire/√©crire des fichiers doit √™tre adapt√© pour utiliser <strong>Object Storage</strong> via <strong>DBMS_CLOUD</strong>. C'est l'objet de ce projet de migration."
                    </p>
                </div>
            </div>
        </div>

        <div style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 15px; padding: 25px; margin: 20px 0; border: 2px solid #2196f3;">
            <pre style="background: transparent; color: #333; font-family: 'Courier New', monospace; font-size: 0.85rem; line-height: 1.6; margin: 0; overflow-x: auto;">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                    ‚òÅÔ∏è CLOUD OCI                                          ‚îÇ
‚îÇ                                                                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ         üóÑÔ∏è ExaCC (ta base de donn√©es)       ‚îÇ     ‚îÇ    üì¶ Object Storage (Bucket)  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                                             ‚îÇ     ‚îÇ                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                        ‚îÇ     ‚îÇ    C'est ton nouveau           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  üìù Code PL/SQL ‚îÇ                        ‚îÇ     ‚îÇ    "disque dur cloud"          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ                 ‚îÇ                        ‚îÇ     ‚îÇ                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  UTL_FILE.FOPEN ‚îÇ ‚óÑ‚îÄ‚îÄ Ton code ne       ‚îÇ     ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  ('DATA_EXPORT',‚îÇ     change PAS !       ‚îÇ     ‚îÇ  ‚îÇ üìÅ DATA_EXPORT/          ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ   'fichier.txt')‚îÇ                        ‚îÇ     ‚îÇ  ‚îÇ    üìÑ fichier.txt        ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îÇ     ‚îÇ  ‚îÇ    üìÑ export.csv         ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚îÇ                                 ‚îÇ     ‚îÇ  ‚îÇ                          ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚ñº                                 ‚îÇ     ‚îÇ  ‚îÇ üìÅ LOG_DIR/              ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                        ‚îÇ     ‚îÇ  ‚îÇ    üìÑ batch.log          ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ üîÑ SYNONYME     ‚îÇ  "Quand tu dis         ‚îÇ     ‚îÇ  ‚îÇ                          ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ UTL_FILE =      ‚îÇ   UTL_FILE, je         ‚îÇ     ‚îÇ  ‚îÇ üìÅ REPORTS/              ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ UTL_FILE_WRAPPER‚îÇ   comprends WRAPPER"   ‚îÇ     ‚îÇ  ‚îÇ    üìÑ rapport.pdf        ‚îÇ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îÇ     ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚îÇ                                 ‚îÇ     ‚îÇ               ‚ñ≤                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚ñº                                 ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                        ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ üì¶ WRAPPER      ‚îÇ  Le traducteur !       ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ UTL_FILE_WRAPPER‚îÇ                        ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚îÇ                                 ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚ñº                                 ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                        ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ üìã TABLE MAPPING‚îÇ  "DATA_EXPORT" =       ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ directory ‚Üí URL ‚îÇ  https://object...     ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚îÇ                                 ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ           ‚ñº                                 ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    HTTPS (port 443)    ‚îÇ     ‚îÇ               ‚îÇ                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ üîå DBMS_CLOUD   ‚îÇ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ (package Oracle)‚îÇ    + CREDENTIAL        ‚îÇ     ‚îÇ                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    (authentification)  ‚îÇ     ‚îÇ                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                                             ‚îÇ     ‚îÇ                                ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                                                          ‚îÇ
‚îÇ         ‚ñ≤                                                        ‚ñ≤                       ‚îÇ
‚îÇ         ‚îÇ                    üîí ACL (Firewall interne)           ‚îÇ                       ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ autorise la connexion ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                       ‚îÇ
‚îÇ                                                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            </pre>
        </div>

        <!-- Explication du flux -->
        <h3>üîÑ Le Flux Expliqu√© Pas √† Pas</h3>

        <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin: 20px 0;">
            <table style="width: 100%; border-collapse: collapse;">
                <tr>
                    <td style="width: 60px; text-align: center; vertical-align: top; padding: 15px;">
                        <span style="background: #4caf50; color: white; border-radius: 50%; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">1</span>
                    </td>
                    <td style="padding: 15px; border-bottom: 1px solid #e0e0e0;">
                        <strong>Ton code appelle UTL_FILE</strong><br>
                        <code style="background: #fff3e0; padding: 5px 10px; border-radius: 5px;">UTL_FILE.FOPEN('DATA_EXPORT', 'rapport.txt', 'W')</code><br>
                        <small style="color: #666;">üëâ Ton code PL/SQL n'a pas chang√©, il utilise toujours UTL_FILE comme avant !</small>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center; vertical-align: top; padding: 15px;">
                        <span style="background: #2196f3; color: white; border-radius: 50%; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">2</span>
                    </td>
                    <td style="padding: 15px; border-bottom: 1px solid #e0e0e0;">
                        <strong>Le SYNONYME redirige vers le WRAPPER</strong><br>
                        <small style="color: #666;">üëâ Oracle dit : "UTL_FILE ? Je connais pas, mais j'ai un synonyme qui me dit d'utiliser UTL_FILE_WRAPPER √† la place !"</small><br>
                        <span style="background: #e3f2fd; padding: 5px 10px; border-radius: 5px; display: inline-block; margin-top: 5px;">UTL_FILE ‚Üí UTL_FILE_WRAPPER (automatique, invisible)</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center; vertical-align: top; padding: 15px;">
                        <span style="background: #ff9800; color: white; border-radius: 50%; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">3</span>
                    </td>
                    <td style="padding: 15px; border-bottom: 1px solid #e0e0e0;">
                        <strong>Le WRAPPER consulte la TABLE DE MAPPING</strong><br>
                        <small style="color: #666;">üëâ Le wrapper cherche : "DATA_EXPORT, c'est quoi en URL cloud ?"</small><br>
                        <table style="margin: 10px 0; font-size: 0.9rem; background: white;">
                            <tr style="background: #ffecb3;"><td style="padding: 8px;"><code>DATA_EXPORT</code></td><td style="padding: 8px;">‚Üí</td><td style="padding: 8px;"><code>https://objectstorage.eu-paris-1.oraclecloud.com/.../DATA_EXPORT/</code></td></tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center; vertical-align: top; padding: 15px;">
                        <span style="background: #9c27b0; color: white; border-radius: 50%; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">4</span>
                    </td>
                    <td style="padding: 15px; border-bottom: 1px solid #e0e0e0;">
                        <strong>Le WRAPPER appelle DBMS_CLOUD avec le CREDENTIAL</strong><br>
                        <small style="color: #666;">üëâ Le wrapper dit √† DBMS_CLOUD : "Envoie ce fichier √† cette URL, voici le mot de passe (credential)"</small><br>
                        <code style="background: #f3e5f5; padding: 5px 10px; border-radius: 5px; display: inline-block; margin-top: 5px;">DBMS_CLOUD.PUT_OBJECT(credential_name => 'MON_CREDENTIAL', ...)</code>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center; vertical-align: top; padding: 15px;">
                        <span style="background: #f44336; color: white; border-radius: 50%; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">5</span>
                    </td>
                    <td style="padding: 15px; border-bottom: 1px solid #e0e0e0;">
                        <strong>L'ACL autorise la connexion r√©seau</strong><br>
                        <small style="color: #666;">üëâ Le firewall interne OCI v√©rifie : "ExaCC a-t-il le droit de parler √† Object Storage ?" ‚Üí OUI</small><br>
                        <span style="background: #ffebee; padding: 5px 10px; border-radius: 5px; display: inline-block; margin-top: 5px;">üîí C'est une r√®gle de s√©curit√© INTERNE au cloud (pas Internet)</span>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center; vertical-align: top; padding: 15px;">
                        <span style="background: #4caf50; color: white; border-radius: 50%; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem;">‚úì</span>
                    </td>
                    <td style="padding: 15px;">
                        <strong>Le fichier arrive dans Object Storage !</strong><br>
                        <small style="color: #666;">üëâ Ton fichier <code>rapport.txt</code> est maintenant stock√© dans le bucket, accessible via URL</small><br>
                        <code style="background: #e8f5e9; padding: 5px 10px; border-radius: 5px; display: inline-block; margin-top: 5px;">https://objectstorage.../DATA_EXPORT/rapport.txt</code>
                    </td>
                </tr>
            </table>
        </div>

        <!-- C'est quoi l'ACL -->
        <h3>üîí C'est quoi l'ACL exactement ?</h3>

        <div class="alert alert-warning" style="margin: 20px 0;">
            <span class="alert-icon">üîê</span>
            <div>
                <strong>ACL = Access Control List (Liste de Contr√¥le d'Acc√®s)</strong>
                <p style="margin: 10px 0;">M√™me si ta base ExaCC et Object Storage sont <strong>tous les deux dans le cloud OCI</strong>, ils ne peuvent pas se parler automatiquement. C'est une mesure de s√©curit√©.</p>
                <p style="margin: 10px 0;">L'ACL est une r√®gle qui dit : <em>"La base de donn√©es ExaCC a le droit de se connecter √† Object Storage sur le port 443 (HTTPS)"</em></p>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
            <div style="background: #ffebee; border-radius: 10px; padding: 20px; border-left: 5px solid #f44336;">
                <h4 style="margin: 0 0 10px 0; color: #c62828;">‚ùå Sans ACL configur√©e</h4>
                <p style="margin: 0; font-size: 0.95rem;">Ta base essaie d'acc√©der √† Object Storage ‚Üí <strong>BLOQU√â</strong> par le firewall interne OCI</p>
                <p style="margin: 10px 0 0 0; font-size: 0.85rem; color: #666;">Erreur : <code>ORA-29024: Certificate validation failure</code> ou timeout</p>
            </div>
            <div style="background: #e8f5e9; border-radius: 10px; padding: 20px; border-left: 5px solid #4caf50;">
                <h4 style="margin: 0 0 10px 0; color: #2e7d32;">‚úÖ Avec ACL configur√©e</h4>
                <p style="margin: 0; font-size: 0.95rem;">Ta base acc√®de √† Object Storage ‚Üí <strong>AUTORIS√â</strong></p>
                <p style="margin: 10px 0 0 0; font-size: 0.85rem; color: #666;">Les fichiers sont lus/√©crits normalement</p>
            </div>
        </div>

        <div style="background: #e8f5e9; border-radius: 10px; padding: 20px; margin: 20px 0;">
            <strong>üéØ Bonne nouvelle pour toi :</strong>
            <p style="margin: 10px 0 0 0;">L'ACL est configur√©e par les <strong>admins OCI</strong>, pas par toi. Tu dois juste leur demander de confirmer que c'est fait. Dans ton email, demande simplement : <em>"Pouvez-vous confirmer que l'ACL autorise la base ExaCC √† acc√©der √† Object Storage ?"</em></p>
        </div>

        <!-- Analogie finale -->
        <h3>üè† Analogie Compl√®te : Le D√©m√©nagement</h3>

        <div style="background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%); border-radius: 15px; padding: 25px; margin: 20px 0;">
            <table style="width: 100%; border-collapse: collapse;">
                <tr>
                    <th style="text-align: left; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 5px;">√âl√©ment technique</th>
                    <th style="text-align: left; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 5px;">Analogie du d√©m√©nagement</th>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>On-Premise ‚Üí ExaCC</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">Tu d√©m√©nages de ta maison vers un appartement en r√©sidence</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>UTL_FILE (ancien)</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">Tu rangeais tes affaires dans ton garage personnel</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>Object Storage (nouveau)</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">Maintenant tu utilises un garde-meuble s√©curis√© de la r√©sidence</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>URI du Bucket</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">L'adresse du garde-meuble</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>Credential</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">La cl√©/badge pour ouvrir le garde-meuble</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>ACL</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">Le gardien de la r√©sidence qui v√©rifie que tu as le droit d'acc√©der au garde-meuble</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>Table de Mapping</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">Un carnet qui dit "les outils du garage ‚Üí casier A3 du garde-meuble"</td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);"><strong>Wrapper</strong></td>
                    <td style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1);">Un assistant qui transporte tes affaires entre l'appart et le garde-meuble automatiquement</td>
                </tr>
                <tr>
                    <td style="padding: 12px;"><strong>Synonyme</strong></td>
                    <td style="padding: 12px;">Tu dis toujours "je range au garage" mais l'assistant comprend "je mets au garde-meuble"</td>
                </tr>
            </table>
        </div>

    </section>

    <!-- √âtape 1 : Audit -->
    <section>
        <h2>üîç √âtape 1 : Audit UTL_FILE (√Ä faire maintenant)</h2>

        <div class="alert alert-success">
            <span class="alert-icon">‚ñ∂Ô∏è</span>
            <div>
                <strong>Tu peux commencer tout de suite !</strong><br>
                Cette √©tape ne d√©pend pas des admins OCI. Lance l'audit pour conna√Ætre l'ampleur du travail.
            </div>
        </div>

        <h3>1.1 Compter les utilisations</h3>
        <div class="code-container">
            <div class="code-header">
                <span>SQL - Comptage global (sch√©ma courant)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- AUDIT POUR LE SCH√âMA COURANT (USER)
-- ============================================
-- Ex√©cute ce script connect√© au sch√©ma √† auditer

-- Afficher le sch√©ma courant
SELECT USER AS schema_courant FROM DUAL;

-- Nombre total de r√©f√©rences UTL_FILE dans CE sch√©ma
SELECT COUNT(*) AS total_references
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%';

-- Nombre d'objets distincts impact√©s dans CE sch√©ma
SELECT COUNT(DISTINCT name) AS objets_impactes
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%';</code></pre>
        </div>

        <h3>1.2 Liste des objets √† modifier</h3>
        <div class="code-container">
            <div class="code-header">
                <span>SQL - Liste d√©taill√©e des objets (sch√©ma courant)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- Liste des objets utilisant UTL_FILE dans le sch√©ma courant
SELECT
    USER AS owner,
    name AS object_name,
    type AS object_type,
    COUNT(*) AS nb_references
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
GROUP BY name, type
ORDER BY nb_references DESC;</code></pre>
        </div>

        <h3>1.3 Fonctions UTL_FILE utilis√©es et compatibilit√© wrapper</h3>
        <div class="code-container">
            <div class="code-header">
                <span>SQL - Liste des fonctions UTL_FILE utilis√©es et leur support</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- FONCTIONS UTL_FILE UTILIS√âES ET COMPATIBILIT√â WRAPPER
-- ============================================
-- Cette requ√™te liste toutes les fonctions UTL_FILE utilis√©es
-- et indique si elles sont support√©es par UTL_FILE_WRAPPER

SET LINESIZE 200
SET PAGESIZE 100
COLUMN fonction FORMAT A20
COLUMN nb_utilisations FORMAT 9999
COLUMN supporte_wrapper FORMAT A20

SELECT
    fonction,
    nb_utilisations,
    CASE
        WHEN fonction IN ('FOPEN', 'FCLOSE', 'FCLOSE_ALL', 'PUT_LINE', 'PUT',
                          'GET_LINE', 'NEW_LINE', 'FFLUSH', 'IS_OPEN',
                          'PUT_RAW', 'GET_RAW', 'FGETATTR',
                          'FCOPY', 'FRENAME', 'FREMOVE', 'FILE_TYPE')
        THEN '‚úÖ OUI'
        ELSE '‚ùå NON'
    END AS supporte_wrapper
FROM (
    SELECT
        CASE
            WHEN UPPER(text) LIKE '%UTL_FILE.FOPEN%' THEN 'FOPEN'
            WHEN UPPER(text) LIKE '%UTL_FILE.FCLOSE_ALL%' THEN 'FCLOSE_ALL'
            WHEN UPPER(text) LIKE '%UTL_FILE.FCLOSE%' THEN 'FCLOSE'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUT_LINE%' THEN 'PUT_LINE'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUT_RAW%' THEN 'PUT_RAW'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUT%' AND UPPER(text) NOT LIKE '%PUT_LINE%' AND UPPER(text) NOT LIKE '%PUT_RAW%' THEN 'PUT'
            WHEN UPPER(text) LIKE '%UTL_FILE.GET_LINE%' THEN 'GET_LINE'
            WHEN UPPER(text) LIKE '%UTL_FILE.GET_RAW%' THEN 'GET_RAW'
            WHEN UPPER(text) LIKE '%UTL_FILE.NEW_LINE%' THEN 'NEW_LINE'
            WHEN UPPER(text) LIKE '%UTL_FILE.FFLUSH%' THEN 'FFLUSH'
            WHEN UPPER(text) LIKE '%UTL_FILE.IS_OPEN%' THEN 'IS_OPEN'
            WHEN UPPER(text) LIKE '%UTL_FILE.FGETATTR%' THEN 'FGETATTR'
            WHEN UPPER(text) LIKE '%UTL_FILE.FCOPY%' THEN 'FCOPY'
            WHEN UPPER(text) LIKE '%UTL_FILE.FRENAME%' THEN 'FRENAME'
            WHEN UPPER(text) LIKE '%UTL_FILE.FREMOVE%' THEN 'FREMOVE'
            WHEN UPPER(text) LIKE '%UTL_FILE.FILE_TYPE%' OR UPPER(text) LIKE '%FILE_TYPE%' THEN 'FILE_TYPE'
            WHEN UPPER(text) LIKE '%UTL_FILE.FSEEK%' THEN 'FSEEK'
            WHEN UPPER(text) LIKE '%UTL_FILE.FGETPOS%' THEN 'FGETPOS'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUTF%' THEN 'PUTF'
            ELSE 'AUTRE'
        END AS fonction,
        COUNT(*) AS nb_utilisations
    FROM user_source
    WHERE UPPER(text) LIKE '%UTL_FILE%'
    GROUP BY
        CASE
            WHEN UPPER(text) LIKE '%UTL_FILE.FOPEN%' THEN 'FOPEN'
            WHEN UPPER(text) LIKE '%UTL_FILE.FCLOSE_ALL%' THEN 'FCLOSE_ALL'
            WHEN UPPER(text) LIKE '%UTL_FILE.FCLOSE%' THEN 'FCLOSE'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUT_LINE%' THEN 'PUT_LINE'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUT_RAW%' THEN 'PUT_RAW'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUT%' AND UPPER(text) NOT LIKE '%PUT_LINE%' AND UPPER(text) NOT LIKE '%PUT_RAW%' THEN 'PUT'
            WHEN UPPER(text) LIKE '%UTL_FILE.GET_LINE%' THEN 'GET_LINE'
            WHEN UPPER(text) LIKE '%UTL_FILE.GET_RAW%' THEN 'GET_RAW'
            WHEN UPPER(text) LIKE '%UTL_FILE.NEW_LINE%' THEN 'NEW_LINE'
            WHEN UPPER(text) LIKE '%UTL_FILE.FFLUSH%' THEN 'FFLUSH'
            WHEN UPPER(text) LIKE '%UTL_FILE.IS_OPEN%' THEN 'IS_OPEN'
            WHEN UPPER(text) LIKE '%UTL_FILE.FGETATTR%' THEN 'FGETATTR'
            WHEN UPPER(text) LIKE '%UTL_FILE.FCOPY%' THEN 'FCOPY'
            WHEN UPPER(text) LIKE '%UTL_FILE.FRENAME%' THEN 'FRENAME'
            WHEN UPPER(text) LIKE '%UTL_FILE.FREMOVE%' THEN 'FREMOVE'
            WHEN UPPER(text) LIKE '%UTL_FILE.FILE_TYPE%' OR UPPER(text) LIKE '%FILE_TYPE%' THEN 'FILE_TYPE'
            WHEN UPPER(text) LIKE '%UTL_FILE.FSEEK%' THEN 'FSEEK'
            WHEN UPPER(text) LIKE '%UTL_FILE.FGETPOS%' THEN 'FGETPOS'
            WHEN UPPER(text) LIKE '%UTL_FILE.PUTF%' THEN 'PUTF'
            ELSE 'AUTRE'
        END
)
ORDER BY nb_utilisations DESC;</code></pre>
        </div>

        <div class="alert alert-success">
            <span class="alert-icon">‚úÖ</span>
            <div>
                <strong>Fonctions support√©es par UTL_FILE_WRAPPER :</strong><br>
                FOPEN, FCLOSE, FCLOSE_ALL, PUT_LINE, PUT, GET_LINE, NEW_LINE, FFLUSH, IS_OPEN, PUT_RAW, GET_RAW, FGETATTR, FCOPY, FRENAME, FREMOVE, FILE_TYPE
            </div>
        </div>

        <div class="alert alert-warning">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Fonctions NON support√©es (rarement utilis√©es) :</strong><br>
                FSEEK, FGETPOS, PUTF - Si tu utilises ces fonctions, il faudra adapter le wrapper ou modifier le code.
            </div>
        </div>

        <h3>1.4 Export de l'audit complet</h3>
        <div class="code-container">
            <div class="code-header">
                <span>SQL - Export CSV pour Excel (sch√©ma courant)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- G√©n√©rer un rapport CSV pour le sch√©ma courant
SET MARKUP CSV ON
SET LINESIZE 32767
SET PAGESIZE 0
SPOOL utl_file_audit.csv

SELECT
    USER AS owner,
    name,
    type,
    line,
    REPLACE(TRIM(text), ',', ';') AS code_line
FROM user_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
ORDER BY name, type, line;

SPOOL OFF
SET MARKUP CSV OFF</code></pre>
        </div>
    </section>

    <!-- Ce que tu attends des admins -->
    <section>
        <h2>‚è≥ Ce que tu attends des Admins OCI</h2>

        <div class="alert alert-warning">
            <span class="alert-icon">üì•</span>
            <div>
                <strong>Informations √† recevoir</strong><br>
                Une fois que tu auras ces informations, tu pourras continuer les √©tapes 3, 4 et 5.
            </div>
        </div>

        <div class="card-grid">
            <div class="card">
                <h4>1. URI du Bucket</h4>
                <p>Format attendu :</p>
                <code style="background:#f5f5f5;padding:5px;display:block;margin-top:10px;font-size:0.85rem;word-break:break-all;">
                https://objectstorage.eu-paris-1.oraclecloud.com/n/[namespace]/b/[bucket]/o/
                </code>
                <p style="margin-top:10px;"><strong>Re√ßu :</strong> <input type="text" id="bucket_uri" style="width:100%;padding:5px;margin-top:5px;" placeholder="Coller l'URI ici..."></p>
            </div>
            <div class="card">
                <h4>2. Nom du Credential</h4>
                <p>Le credential DBMS_CLOUD cr√©√© en base pour l'authentification.</p>
                <p style="margin-top:10px;"><strong>Re√ßu :</strong> <input type="text" id="credential_name" style="width:100%;padding:5px;margin-top:5px;" placeholder="Ex: OCI_CREDENTIAL"></p>
            </div>
            <div class="card">
                <h4>3. ACL R√©seau</h4>
                <p>Confirmation que la base peut acc√©der √† *.oraclecloud.com:443</p>
                <p style="margin-top:10px;">
                    <label><input type="checkbox" id="acl_confirmed"> Confirm√© par les admins</label>
                </p>
            </div>
            <div class="card">
                <h4>4. Dossiers cr√©√©s</h4>
                <p>Les prefixes (dossiers) cr√©√©s dans le bucket.</p>
                <p style="margin-top:10px;"><strong>Liste :</strong></p>
                <textarea id="folders_list" style="width:100%;height:60px;padding:5px;" placeholder="DATA_EXPORT/&#10;LOG_DIR/&#10;REPORTS/"></textarea>
            </div>
        </div>

        <div style="text-align:center;margin-top:20px;">
            <button onclick="saveConfig()" style="background:var(--primary);color:white;padding:10px 30px;border:none;border-radius:5px;cursor:pointer;font-size:1rem;">
                üíæ Sauvegarder (localStorage)
            </button>
        </div>
    </section>

    <!-- √âtape 3 : Table de mapping -->
    <section>
        <h2>üìä √âtape 3 : Cr√©er la Table de Mapping</h2>

        <div class="alert alert-info">
            <span class="alert-icon">‚è≥</span>
            <div>
                <strong>Pr√©requis</strong><br>
                Tu dois avoir re√ßu l'URI du bucket des admins OCI avant de cr√©er cette table.
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Cr√©ation de la table de mapping (sch√©ma courant)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- CR√âATION TABLE DE MAPPING - SCH√âMA COURANT
-- ============================================
-- La table sera cr√©√©e dans le sch√©ma o√π tu es connect√©

-- Afficher le sch√©ma courant
SELECT USER AS schema_courant FROM DUAL;

-- Cr√©er la table de mapping (dans le sch√©ma courant)
CREATE TABLE utl_file_directory_mapping (
    mapping_id         NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    oracle_directory   VARCHAR2(128) NOT NULL UNIQUE,
    object_storage_uri VARCHAR2(1000) NOT NULL,
    credential_name    VARCHAR2(128) DEFAULT 'OCI_CREDENTIAL',
    is_active          VARCHAR2(1) DEFAULT 'Y',
    created_date       DATE DEFAULT SYSDATE
);

-- Index pour performance
CREATE INDEX idx_mapping_dir ON utl_file_directory_mapping(oracle_directory);

-- V√©rifier la cr√©ation
SELECT table_name FROM user_tables WHERE table_name = 'UTL_FILE_DIRECTORY_MAPPING';</code></pre>
        </div>

        <h3>Ins√©rer les mappings</h3>
        <div class="code-container" id="code-insert-mappings">
            <div class="code-header">
                <span>SQL - Insertion des mappings <span class="auto-update-badge" style="display:none; background:#4caf50; color:white; padding:2px 8px; border-radius:10px; font-size:0.75rem; margin-left:10px;">‚úÖ Mis √† jour auto</span></span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code id="sql-insert-mappings">-- ============================================
-- INSERTION DES MAPPINGS DIRECTORY ‚Üí OBJECT STORAGE
-- ============================================

DECLARE
    v_base_uri VARCHAR2(500) := '<span class="placeholder-uri">[URI_BUCKET]</span>';
    v_credential VARCHAR2(100) := '<span class="placeholder-cred">[CREDENTIAL]</span>';
BEGIN
<span id="sql-insert-lines">    -- Adapter cette liste selon ton audit
    INSERT INTO utl_file_directory_mapping (oracle_directory, object_storage_uri, credential_name)
    VALUES ('DATA_EXPORT', v_base_uri || 'DATA_EXPORT/', v_credential);

    INSERT INTO utl_file_directory_mapping (oracle_directory, object_storage_uri, credential_name)
    VALUES ('LOG_DIR', v_base_uri || 'LOG_DIR/', v_credential);

    INSERT INTO utl_file_directory_mapping (oracle_directory, object_storage_uri, credential_name)
    VALUES ('REPORT_DIR', v_base_uri || 'REPORT_DIR/', v_credential);

    -- Ajouter d'autres directories selon ton audit...</span>

    COMMIT;
END;
/

-- V√©rifier les mappings ins√©r√©s
SELECT oracle_directory, object_storage_uri, credential_name
FROM utl_file_directory_mapping
ORDER BY oracle_directory;</code></pre>
        </div>
    </section>

    <!-- √âtape 4 : Package wrapper -->
    <section>
        <h2>üì¶ √âtape 4 : D√©ployer le Package Wrapper</h2>

        <div class="alert alert-info">
            <span class="alert-icon">üìÑ</span>
            <div>
                <strong>Package complet</strong><br>
                Le code complet du package UTL_FILE_WRAPPER est disponible dans le document principal :
                <a href="migration-utl-file-exacc.html#wrapper" style="color:var(--secondary);">migration-utl-file-exacc.html ‚Üí Section Package Wrapper</a>
            </div>
        </div>

        <h3>R√©sum√© des √©tapes</h3>
        <ol style="padding-left: 20px;">
            <li style="margin: 10px 0;">Copier le code du <strong>Package Specification</strong> et l'ex√©cuter</li>
            <li style="margin: 10px 0;">Copier le code du <strong>Package Body</strong> et l'ex√©cuter</li>
            <li style="margin: 10px 0;">V√©rifier que le package est VALID :
                <code style="background:#f5f5f5;padding:3px 8px;margin-left:10px;">SELECT status FROM user_objects WHERE object_name = 'UTL_FILE_WRAPPER';</code>
            </li>
            <li style="margin: 10px 0;">Donner les grants aux utilisateurs qui en ont besoin</li>
        </ol>
    </section>

    <!-- √âtape 5 : Migration -->
    <section>
        <h2>üîÑ √âtape 5 : Cr√©er le Synonyme et Tester</h2>

        <div class="alert alert-success">
            <span class="alert-icon">‚≠ê</span>
            <div>
                <strong>M√©thode utilis√©e : Le Synonyme</strong><br>
                Avec plus de 1000 utilisations de UTL_FILE, le synonyme est la seule option viable. Z√©ro modification de code = z√©ro risque d'erreur.
            </div>
        </div>

        <h3>‚úÖ Cr√©ation du Synonyme</h3>

        <div class="alert alert-info" style="margin-bottom: 15px;">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Pourquoi le synonyme est la meilleure solution ?</strong>
                <table style="margin: 15px 0; width: 100%;">
                    <tr>
                        <th style="background: var(--primary); color: white; padding: 10px;">Avantage</th>
                        <th style="background: var(--primary); color: white; padding: 10px;">Explication</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Z√©ro modification de code</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Tes 1000+ proc√©dures restent identiques, pas de risque d'introduire des bugs</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Rollback instantan√©</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Si probl√®me, tu supprimes le synonyme et tout redevient comme avant en 1 seconde</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Pas de tests de non-r√©gression</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Le code n'ayant pas chang√©, pas besoin de tout re-tester ligne par ligne</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Migration en 5 minutes</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Au lieu de jours/semaines pour modifier 1000 proc√©dures</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Transparent pour les devs</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Les d√©veloppeurs continuent √† √©crire <code>UTL_FILE</code> sans rien changer</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="alert alert-warning" style="margin-bottom: 15px;">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Pr√©requis : Privil√®ge CREATE PUBLIC SYNONYM</strong><br>
                Pour cr√©er un synonyme PUBLIC, tu dois avoir le privil√®ge <code>CREATE PUBLIC SYNONYM</code> ou √™tre connect√© en tant que DBA/SYS.
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Migration par SYNONYME PUBLIC (tous les sch√©mas)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- MIGRATION UTL_FILE PAR SYNONYME PUBLIC
-- ============================================
-- Avantage : UNE SEULE commande pour TOUS les sch√©mas !
-- Ex√©cute ce script en tant que DBA ou utilisateur avec CREATE PUBLIC SYNONYM

-- Afficher l'utilisateur courant
SELECT USER AS utilisateur_courant FROM DUAL;


-- √âTAPE 1 : Identifier le sch√©ma o√π est d√©ploy√© le wrapper
-- --------------------------------------------------------
-- Le wrapper doit √™tre dans UN sch√©ma (ex: SCHEMA_COMMON ou le premier sch√©ma migr√©)
SELECT owner, object_name, object_type, status
FROM dba_objects
WHERE object_name = 'UTL_FILE_WRAPPER'
  AND object_type IN ('PACKAGE', 'PACKAGE BODY')
ORDER BY owner;
-- Note le OWNER o√π le wrapper est VALID (ex: SCHEMA_COMMON)


-- √âTAPE 2 : Cr√©er le SYNONYME PUBLIC
-- ----------------------------------
-- ‚ö†Ô∏è REMPLACE "SCHEMA_WRAPPER" par le sch√©ma o√π tu as d√©ploy√© le wrapper
CREATE OR REPLACE PUBLIC SYNONYM UTL_FILE FOR SCHEMA_WRAPPER.UTL_FILE_WRAPPER;

-- V√©rifier que le synonyme est cr√©√©
SELECT owner, synonym_name, table_owner, table_name
FROM dba_synonyms
WHERE synonym_name = 'UTL_FILE'
  AND owner = 'PUBLIC';


-- √âTAPE 3 : Recompiler TOUS les sch√©mas impact√©s
-- ----------------------------------------------
-- Liste des sch√©mas utilisant UTL_FILE
SELECT DISTINCT owner
FROM dba_source
WHERE UPPER(text) LIKE '%UTL_FILE%'
  AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM')
ORDER BY owner;

-- Recompiler chaque sch√©ma (adapter la liste)
BEGIN
    DBMS_UTILITY.COMPILE_SCHEMA(schema => 'SCHEMA_APP1', compile_all => FALSE);
    DBMS_UTILITY.COMPILE_SCHEMA(schema => 'SCHEMA_APP2', compile_all => FALSE);
    DBMS_UTILITY.COMPILE_SCHEMA(schema => 'SCHEMA_BATCH', compile_all => FALSE);
    -- Ajouter les autres sch√©mas...
END;
/

-- Ou recompiler automatiquement TOUS les sch√©mas impact√©s
BEGIN
    FOR rec IN (
        SELECT DISTINCT owner
        FROM dba_source
        WHERE UPPER(text) LIKE '%UTL_FILE%'
          AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM')
    ) LOOP
        DBMS_OUTPUT.PUT_LINE('Recompilation du sch√©ma: ' || rec.owner);
        DBMS_UTILITY.COMPILE_SCHEMA(schema => rec.owner, compile_all => FALSE);
    END LOOP;
END;
/


-- √âTAPE 4 : V√©rifier qu'il n'y a plus d'objets invalides
-- -----------------------------------------------------
SELECT owner, object_name, object_type, status
FROM dba_objects
WHERE status = 'INVALID'
  AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM')
ORDER BY owner, object_name;
-- Cette requ√™te doit retourner 0 ligne


-- ============================================
-- TEST RAPIDE (depuis n'importe quel sch√©ma)
-- ============================================
SET SERVEROUTPUT ON
DECLARE
    v_file UTL_FILE.FILE_TYPE;
BEGIN
    DBMS_OUTPUT.PUT_LINE('Test depuis le sch√©ma: ' || USER);
    v_file := UTL_FILE.FOPEN('DATA_EXPORT', 'test_' || USER || '.txt', 'W');
    UTL_FILE.PUT_LINE(v_file, 'Test synonyme PUBLIC OK - ' || SYSDATE);
    UTL_FILE.FCLOSE(v_file);
    DBMS_OUTPUT.PUT_LINE('‚úÖ Synonyme PUBLIC fonctionne pour ' || USER || ' !');
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('‚ùå Erreur: ' || SQLERRM);
END;
/</code></pre>
        </div>

        <h3>üîÑ Rollback complet si probl√®me</h3>

        <div class="alert alert-danger">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Script de rollback complet</strong><br>
                Ce script annule enti√®rement la migration et revient √† UTL_FILE natif Oracle.
                √Ä ex√©cuter en tant que DBA (SYSDBA).
            </div>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - ROLLBACK COMPLET (ex√©cuter en SYSDBA)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- ROLLBACK COMPLET - MIGRATION UTL_FILE
-- ============================================
-- Ex√©cuter en tant que SYSDBA
-- Ce script annule toute la migration et revient √† UTL_FILE natif

SET SERVEROUTPUT ON
SET LINESIZE 200

DECLARE
    v_count NUMBER;
    v_schema VARCHAR2(128) := 'SCHEMA_WRAPPER';  -- ‚ö†Ô∏è ADAPTER: Sch√©ma o√π le wrapper a √©t√© install√©
BEGIN
    DBMS_OUTPUT.PUT_LINE('========================================');
    DBMS_OUTPUT.PUT_LINE('ROLLBACK MIGRATION UTL_FILE - D√âBUT');
    DBMS_OUTPUT.PUT_LINE('========================================');
    DBMS_OUTPUT.PUT_LINE('');

    -- ============================================
    -- √âTAPE 1 : Supprimer le synonyme PUBLIC
    -- ============================================
    DBMS_OUTPUT.PUT_LINE('√âTAPE 1 : Suppression du synonyme PUBLIC UTL_FILE...');
    BEGIN
        EXECUTE IMMEDIATE 'DROP PUBLIC SYNONYM UTL_FILE';
        DBMS_OUTPUT.PUT_LINE('   ‚úÖ Synonyme PUBLIC UTL_FILE supprim√©');
    EXCEPTION
        WHEN OTHERS THEN
            IF SQLCODE = -1432 THEN
                DBMS_OUTPUT.PUT_LINE('   ‚ÑπÔ∏è Synonyme PUBLIC UTL_FILE n''existait pas');
            ELSE
                DBMS_OUTPUT.PUT_LINE('   ‚ùå Erreur: ' || SQLERRM);
            END IF;
    END;

    -- ============================================
    -- √âTAPE 2 : Supprimer le package UTL_FILE_WRAPPER
    -- ============================================
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('√âTAPE 2 : Suppression du package UTL_FILE_WRAPPER...');
    BEGIN
        EXECUTE IMMEDIATE 'DROP PACKAGE ' || v_schema || '.UTL_FILE_WRAPPER';
        DBMS_OUTPUT.PUT_LINE('   ‚úÖ Package UTL_FILE_WRAPPER supprim√©');
    EXCEPTION
        WHEN OTHERS THEN
            IF SQLCODE = -4043 THEN
                DBMS_OUTPUT.PUT_LINE('   ‚ÑπÔ∏è Package UTL_FILE_WRAPPER n''existait pas');
            ELSE
                DBMS_OUTPUT.PUT_LINE('   ‚ùå Erreur: ' || SQLERRM);
            END IF;
    END;

    -- ============================================
    -- √âTAPE 3 : Supprimer la table de mapping
    -- ============================================
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('√âTAPE 3 : Suppression de la table de mapping...');
    BEGIN
        EXECUTE IMMEDIATE 'DROP TABLE ' || v_schema || '.UTL_FILE_DIRECTORY_MAPPING CASCADE CONSTRAINTS';
        DBMS_OUTPUT.PUT_LINE('   ‚úÖ Table UTL_FILE_DIRECTORY_MAPPING supprim√©e');
    EXCEPTION
        WHEN OTHERS THEN
            IF SQLCODE = -942 THEN
                DBMS_OUTPUT.PUT_LINE('   ‚ÑπÔ∏è Table UTL_FILE_DIRECTORY_MAPPING n''existait pas');
            ELSE
                DBMS_OUTPUT.PUT_LINE('   ‚ùå Erreur: ' || SQLERRM);
            END IF;
    END;

    -- ============================================
    -- √âTAPE 4 : Recompiler tous les sch√©mas impact√©s
    -- ============================================
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('√âTAPE 4 : Recompilation des sch√©mas impact√©s...');
    FOR rec IN (
        SELECT DISTINCT owner
        FROM dba_source
        WHERE UPPER(text) LIKE '%UTL_FILE%'
          AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM', 'XDB', 'WMSYS')
        ORDER BY owner
    ) LOOP
        BEGIN
            DBMS_OUTPUT.PUT_LINE('   Recompilation de ' || rec.owner || '...');
            DBMS_UTILITY.COMPILE_SCHEMA(schema => rec.owner, compile_all => FALSE);
            DBMS_OUTPUT.PUT_LINE('   ‚úÖ ' || rec.owner || ' recompil√©');
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE('   ‚ùå Erreur recompilation ' || rec.owner || ': ' || SQLERRM);
        END;
    END LOOP;

    -- ============================================
    -- √âTAPE 5 : V√©rification finale
    -- ============================================
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('√âTAPE 5 : V√©rifications...');

    -- V√©rifier qu'il n'y a plus de synonyme PUBLIC UTL_FILE
    SELECT COUNT(*) INTO v_count
    FROM dba_synonyms
    WHERE synonym_name = 'UTL_FILE' AND owner = 'PUBLIC';

    IF v_count = 0 THEN
        DBMS_OUTPUT.PUT_LINE('   ‚úÖ Aucun synonyme PUBLIC UTL_FILE');
    ELSE
        DBMS_OUTPUT.PUT_LINE('   ‚ùå Synonyme PUBLIC UTL_FILE existe encore !');
    END IF;

    -- V√©rifier les objets invalides
    SELECT COUNT(*) INTO v_count
    FROM dba_objects
    WHERE status = 'INVALID'
      AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM');

    IF v_count = 0 THEN
        DBMS_OUTPUT.PUT_LINE('   ‚úÖ Aucun objet invalide');
    ELSE
        DBMS_OUTPUT.PUT_LINE('   ‚ö†Ô∏è ' || v_count || ' objets invalides (v√©rifier avec requ√™te ci-dessous)');
    END IF;

    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('========================================');
    DBMS_OUTPUT.PUT_LINE('ROLLBACK TERMIN√â');
    DBMS_OUTPUT.PUT_LINE('Le code utilise maintenant UTL_FILE natif Oracle (SYS.UTL_FILE)');
    DBMS_OUTPUT.PUT_LINE('========================================');
END;
/

-- V√©rifier les objets invalides apr√®s rollback
SELECT owner, object_name, object_type, status
FROM dba_objects
WHERE status = 'INVALID'
  AND owner NOT IN ('SYS', 'SYSTEM', 'ORACLE_OCM', 'XDB', 'WMSYS')
ORDER BY owner, object_type, object_name;</code></pre>
        </div>

        <div class="alert alert-info">
            <span class="alert-icon">üí°</span>
            <div>
                <strong>Apr√®s le rollback :</strong><br>
                - Le code PL/SQL utilise √† nouveau UTL_FILE natif (SYS.UTL_FILE)<br>
                - Les fichiers seront √©crits sur le filesystem local (comme avant)<br>
                - Les fichiers d√©j√† dans Object Storage restent accessibles (√† supprimer manuellement si besoin)
            </div>
        </div>

    </section>

    <!-- Test final -->
    <section>
        <h2>‚úÖ Test Final</h2>

        <div class="code-container">
            <div class="code-header">
                <span>SQL - Test d'√©criture/lecture (sch√©ma courant)</span>
                <button class="copy-btn" onclick="copyCode(this)">üìã Copier</button>
            </div>
            <pre><code>-- ============================================
-- TEST COMPLET - SCH√âMA COURANT
-- ============================================
-- Ex√©cute ce test connect√© au sch√©ma migr√©

-- Afficher le sch√©ma courant
SELECT USER AS schema_courant FROM DUAL;

-- Activer l'affichage
SET SERVEROUTPUT ON

DECLARE
    v_file   UTL_FILE.FILE_TYPE;
    v_line   VARCHAR2(32767);
    v_test   VARCHAR2(100) := 'Test migration ' || USER || ' - ' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS');
BEGIN
    DBMS_OUTPUT.PUT_LINE('=== Test pour le sch√©ma: ' || USER || ' ===');
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('Le code utilise UTL_FILE (comme avant)');
    DBMS_OUTPUT.PUT_LINE('Le synonyme redirige vers UTL_FILE_WRAPPER automatiquement');
    DBMS_OUTPUT.PUT_LINE('');

    -- Test √©criture (appel UTL_FILE comme avant migration)
    v_file := UTL_FILE.FOPEN('DATA_EXPORT', 'test_migration_' || USER || '.txt', 'W');
    UTL_FILE.PUT_LINE(v_file, v_test);
    UTL_FILE.FCLOSE(v_file);
    DBMS_OUTPUT.PUT_LINE('‚úÖ √âcriture OK');

    -- Test lecture (appel UTL_FILE comme avant migration)
    v_file := UTL_FILE.FOPEN('DATA_EXPORT', 'test_migration_' || USER || '.txt', 'R');
    UTL_FILE.GET_LINE(v_file, v_line);
    UTL_FILE.FCLOSE(v_file);

    IF v_line = v_test THEN
        DBMS_OUTPUT.PUT_LINE('‚úÖ Lecture OK - Contenu v√©rifi√©');
    ELSE
        DBMS_OUTPUT.PUT_LINE('‚ùå Contenu diff√©rent !');
    END IF;

    -- Nettoyage
    UTL_FILE.FREMOVE('DATA_EXPORT', 'test_migration_' || USER || '.txt');
    DBMS_OUTPUT.PUT_LINE('‚úÖ Suppression OK');

    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('üéâ MIGRATION R√âUSSIE - Le synonyme fonctionne !');
    DBMS_OUTPUT.PUT_LINE('Le code UTL_FILE existant fonctionne sans modification.');

EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('‚ùå Erreur pour ' || USER || ' : ' || SQLERRM);
END;
/</code></pre>
        </div>
    </section>

</div>

<footer>
    <p><strong>Guide DBA - Migration UTL_FILE vers ExaCC</strong></p>
    <p>Document simplifi√© pour le p√©rim√®tre DBA uniquement</p>
</footer>

<script>
// Fonction pour switcher entre les onglets
function showTab(tabId, clickedLink) {
    // Cacher tous les contenus d'onglets
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });

    // D√©sactiver tous les liens de navigation
    document.querySelectorAll('.tabs-nav a').forEach(link => {
        link.classList.remove('active');
    });

    // Afficher l'onglet s√©lectionn√©
    document.getElementById(tabId).classList.add('active');

    // Activer le lien cliqu√©
    clickedLink.classList.add('active');
}

function copyCode(button) {
    const codeContainer = button.closest('.code-container');
    const code = codeContainer.querySelector('pre code').innerText;

    navigator.clipboard.writeText(code).then(() => {
        const originalText = button.innerHTML;
        button.innerHTML = '‚úÖ Copi√©!';
        button.classList.add('copied');
        setTimeout(() => {
            button.innerHTML = originalText;
            button.classList.remove('copied');
        }, 2000);
    });
}

function saveConfig() {
    const config = {
        bucket_uri: document.getElementById('bucket_uri').value,
        credential_name: document.getElementById('credential_name').value,
        acl_confirmed: document.getElementById('acl_confirmed').checked,
        folders_list: document.getElementById('folders_list').value
    };
    localStorage.setItem('exacc_migration_config', JSON.stringify(config));

    // Mettre √† jour les scripts SQL automatiquement
    updateSQLScripts(config);

    alert('‚úÖ Configuration sauvegard√©e et scripts SQL mis √† jour !');
}

function updateSQLScripts(config) {
    const bucketUri = config.bucket_uri || '[URI_BUCKET]';
    const credentialName = config.credential_name || '[CREDENTIAL]';
    const foldersList = config.folders_list || '';

    // Mettre √† jour les placeholders URI
    document.querySelectorAll('.placeholder-uri').forEach(el => {
        el.textContent = bucketUri;
        if (bucketUri !== '[URI_BUCKET]') {
            el.style.background = '#c8e6c9';
            el.style.padding = '2px 4px';
            el.style.borderRadius = '3px';
        }
    });

    // Mettre √† jour les placeholders CREDENTIAL
    document.querySelectorAll('.placeholder-cred').forEach(el => {
        el.textContent = credentialName;
        if (credentialName !== '[CREDENTIAL]') {
            el.style.background = '#c8e6c9';
            el.style.padding = '2px 4px';
            el.style.borderRadius = '3px';
        }
    });

    // G√©n√©rer les INSERT pour chaque dossier
    if (foldersList.trim()) {
        const folders = foldersList.split('\n')
            .map(f => f.trim().replace(/\/$/, ''))  // Enlever les / √† la fin
            .filter(f => f.length > 0);

        if (folders.length > 0) {
            let insertStatements = '    -- G√©n√©r√© automatiquement depuis ta liste de dossiers\n';
            folders.forEach((folder, index) => {
                insertStatements += `    INSERT INTO utl_file_directory_mapping (oracle_directory, object_storage_uri, credential_name)\n`;
                insertStatements += `    VALUES ('${folder.toUpperCase()}', v_base_uri || '${folder.toUpperCase()}/', v_credential);\n`;
                if (index < folders.length - 1) {
                    insertStatements += '\n';
                }
            });

            const insertLinesEl = document.getElementById('sql-insert-lines');
            if (insertLinesEl) {
                insertLinesEl.innerHTML = insertStatements;
            }
        }
    }

    // Afficher les badges "Mis √† jour auto"
    document.querySelectorAll('.auto-update-badge').forEach(badge => {
        if (bucketUri !== '[URI_BUCKET]' || credentialName !== '[CREDENTIAL]') {
            badge.style.display = 'inline';
        }
    });
}

// Charger la config au d√©marrage
window.onload = function() {
    const saved = localStorage.getItem('exacc_migration_config');
    if (saved) {
        const config = JSON.parse(saved);
        document.getElementById('bucket_uri').value = config.bucket_uri || '';
        document.getElementById('credential_name').value = config.credential_name || '';
        document.getElementById('acl_confirmed').checked = config.acl_confirmed || false;
        document.getElementById('folders_list').value = config.folders_list || '';

        // Appliquer les valeurs aux scripts SQL au chargement
        updateSQLScripts(config);
    }
};
</script>

</body>
</html>
